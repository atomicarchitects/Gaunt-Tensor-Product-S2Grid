2024-11-12 18:13:27.520 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=True)
2024-11-12 18:13:27.732 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-12 18:13:27.732 INFO: Loading 3BPA dataset
2024-11-12 18:13:31.518 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-12 18:13:31.520 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-12 18:13:32.329 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-12 18:13:32.368 INFO: Average number of neighbors: 16.712
2024-11-12 18:13:32.368 INFO: Building model
2024-11-12 18:13:33.586 WARNING: Cannot find checkpoint with tag 'gaunt-3bpa_run-6' in 'checkpoints'
2024-11-12 18:13:33.587 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-12 18:13:33.589 INFO: Number of parameters: 2803984
2024-11-12 18:13:33.589 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-12 18:13:33.589 INFO: Started training
2024-11-12 18:14:05.305 INFO: Epoch 0: loss=44.7028
2024-11-12 18:14:49.685 INFO: Epoch 2: loss=8.3191
2024-11-12 18:15:34.024 INFO: Epoch 4: loss=4.9052
2024-11-12 18:16:18.421 INFO: Epoch 6: loss=3.5296
2024-11-12 18:17:02.729 INFO: Epoch 8: loss=2.7335
2024-11-12 18:17:47.247 INFO: Epoch 10: loss=2.2178
2024-11-12 18:18:31.479 INFO: Epoch 12: loss=1.8776
2024-11-12 18:19:15.774 INFO: Epoch 14: loss=1.6277
2024-11-12 18:20:00.149 INFO: Epoch 16: loss=1.4218
2024-11-12 18:20:44.579 INFO: Epoch 18: loss=1.2786
2024-11-12 18:21:28.990 INFO: Epoch 20: loss=1.1328
2024-11-12 18:22:13.382 INFO: Epoch 22: loss=1.0227
2024-11-12 18:22:57.745 INFO: Epoch 24: loss=0.9579
2024-11-12 18:23:42.170 INFO: Epoch 26: loss=0.8793
2024-11-12 18:24:26.609 INFO: Epoch 28: loss=0.8108
2024-11-12 18:25:11.005 INFO: Epoch 30: loss=0.7515
2024-11-12 18:25:55.437 INFO: Epoch 32: loss=0.7033
2024-11-12 18:26:39.877 INFO: Epoch 34: loss=0.6565
2024-11-12 18:27:24.272 INFO: Epoch 36: loss=0.6175
2024-11-12 18:28:08.694 INFO: Epoch 38: loss=0.5819
2024-11-12 18:28:53.102 INFO: Epoch 40: loss=0.5634
2024-11-12 18:29:37.563 INFO: Epoch 42: loss=0.5332
2024-11-12 18:30:21.977 INFO: Epoch 44: loss=0.5118
2024-11-12 18:31:06.373 INFO: Epoch 46: loss=0.4934
2024-11-12 18:31:50.736 INFO: Epoch 48: loss=0.4666
2024-11-12 18:32:35.055 INFO: Epoch 50: loss=0.4531
2024-11-12 18:33:19.572 INFO: Epoch 52: loss=0.4358
2024-11-12 18:34:04.215 INFO: Epoch 54: loss=0.4201
2024-11-12 18:34:48.515 INFO: Epoch 56: loss=0.4091
2024-11-12 18:35:32.835 INFO: Epoch 58: loss=0.3940
2024-11-12 18:36:17.150 INFO: Epoch 60: loss=0.3851
2024-11-12 18:37:01.428 INFO: Epoch 62: loss=0.3769
2024-11-12 18:37:45.798 INFO: Epoch 64: loss=0.3688
2024-11-12 18:38:29.823 INFO: Epoch 66: loss=0.3592
2024-11-12 18:39:14.186 INFO: Epoch 68: loss=0.3502
2024-11-12 18:39:58.534 INFO: Epoch 70: loss=0.3458
2024-11-12 18:40:42.852 INFO: Epoch 72: loss=0.3357
2024-11-12 18:41:27.101 INFO: Epoch 74: loss=0.3277
2024-11-12 18:42:11.411 INFO: Epoch 76: loss=0.3204
2024-11-12 18:42:55.706 INFO: Epoch 78: loss=0.3144
2024-11-12 18:43:40.013 INFO: Epoch 80: loss=0.3075
2024-11-12 18:44:24.283 INFO: Epoch 82: loss=0.3023
2024-11-12 18:45:08.534 INFO: Epoch 84: loss=0.2986
2024-11-12 18:45:52.802 INFO: Epoch 86: loss=0.2885
2024-11-12 18:46:37.047 INFO: Epoch 88: loss=0.2899
2024-11-12 18:47:21.297 INFO: Epoch 90: loss=0.2876
2024-11-12 18:48:05.537 INFO: Epoch 92: loss=0.2777
2024-11-12 18:48:49.797 INFO: Epoch 94: loss=0.2738
2024-11-12 18:49:34.072 INFO: Epoch 96: loss=0.2698
2024-11-12 18:50:18.386 INFO: Epoch 98: loss=0.2664
2024-11-12 18:51:02.656 INFO: Epoch 100: loss=0.2643
2024-11-12 18:51:46.884 INFO: Epoch 102: loss=0.2620
2024-11-12 18:52:31.149 INFO: Epoch 104: loss=0.2602
2024-11-12 18:53:15.400 INFO: Epoch 106: loss=0.2553
2024-11-12 18:53:59.784 INFO: Epoch 108: loss=0.2540
2024-11-12 18:54:44.112 INFO: Epoch 110: loss=0.2524
2024-11-12 18:55:28.426 INFO: Epoch 112: loss=0.2531
2024-11-12 18:56:12.740 INFO: Epoch 114: loss=0.2469
2024-11-12 18:56:57.059 INFO: Epoch 116: loss=0.2444
2024-11-12 18:57:41.413 INFO: Epoch 118: loss=0.2434
2024-11-12 18:58:25.771 INFO: Epoch 120: loss=0.2420
2024-11-12 18:59:10.124 INFO: Epoch 122: loss=0.2369
2024-11-12 18:59:54.522 INFO: Epoch 124: loss=0.2335
2024-11-12 19:00:38.864 INFO: Epoch 126: loss=0.2313
2024-11-12 19:01:23.203 INFO: Epoch 128: loss=0.2295
2024-11-12 19:02:07.513 INFO: Epoch 130: loss=0.2282
2024-11-12 19:02:51.866 INFO: Epoch 132: loss=0.2287
2024-11-12 19:03:36.157 INFO: Epoch 134: loss=0.2237
2024-11-12 19:04:20.605 INFO: Epoch 136: loss=0.2216
2024-11-12 19:05:04.940 INFO: Epoch 138: loss=0.2190
2024-11-12 19:05:49.285 INFO: Epoch 140: loss=0.2163
2024-11-12 19:06:33.604 INFO: Epoch 142: loss=0.2159
2024-11-12 19:07:17.896 INFO: Epoch 144: loss=0.2162
2024-11-12 19:08:02.199 INFO: Epoch 146: loss=0.2134
2024-11-12 19:08:46.638 INFO: Epoch 148: loss=0.2128
2024-11-12 19:09:31.030 INFO: Epoch 150: loss=0.2132
2024-11-12 19:10:15.270 INFO: Epoch 152: loss=0.2098
2024-11-12 19:11:00.021 INFO: Epoch 154: loss=0.2084
2024-11-12 19:11:44.627 INFO: Epoch 156: loss=0.2075
2024-11-12 19:12:29.201 INFO: Epoch 158: loss=0.2061
2024-11-12 19:13:13.744 INFO: Epoch 160: loss=0.2040
2024-11-12 19:13:58.310 INFO: Epoch 162: loss=0.2022
2024-11-12 19:14:42.893 INFO: Epoch 164: loss=0.2018
2024-11-12 19:15:27.432 INFO: Epoch 166: loss=0.2004
2024-11-12 19:16:12.020 INFO: Epoch 168: loss=0.1972
2024-11-12 19:16:56.606 INFO: Epoch 170: loss=0.1969
2024-11-12 19:17:41.224 INFO: Epoch 172: loss=0.1960
2024-11-12 19:18:25.812 INFO: Epoch 174: loss=0.1948
2024-11-12 19:19:10.415 INFO: Epoch 176: loss=0.1951
2024-11-12 19:19:54.960 INFO: Epoch 178: loss=0.1933
2024-11-12 19:20:39.528 INFO: Epoch 180: loss=0.1924
2024-11-12 19:21:24.109 INFO: Epoch 182: loss=0.1903
2024-11-12 19:22:08.669 INFO: Epoch 184: loss=0.1892
2024-11-12 19:22:53.230 INFO: Epoch 186: loss=0.1884
2024-11-12 19:23:37.870 INFO: Epoch 188: loss=0.1878
2024-11-12 19:24:22.527 INFO: Epoch 190: loss=0.1863
2024-11-12 19:25:07.128 INFO: Epoch 192: loss=0.1847
2024-11-12 19:25:51.760 INFO: Epoch 194: loss=0.1827
2024-11-12 19:26:36.389 INFO: Epoch 196: loss=0.1823
2024-11-12 19:27:21.028 INFO: Epoch 198: loss=0.1819
2024-11-12 19:28:05.621 INFO: Epoch 200: loss=0.1831
2024-11-12 19:28:50.168 INFO: Epoch 202: loss=0.1811
2024-11-12 19:29:34.746 INFO: Epoch 204: loss=0.1798
2024-11-12 19:30:19.344 INFO: Epoch 206: loss=0.1784
2024-11-12 19:31:03.972 INFO: Epoch 208: loss=0.1772
2024-11-12 19:31:48.545 INFO: Epoch 210: loss=0.1773
2024-11-12 19:32:33.071 INFO: Epoch 212: loss=0.1769
2024-11-12 19:33:17.647 INFO: Epoch 214: loss=0.1767
2024-11-12 19:34:02.227 INFO: Epoch 216: loss=0.1767
2024-11-12 19:34:46.766 INFO: Epoch 218: loss=0.1745
2024-11-12 19:35:31.330 INFO: Epoch 220: loss=0.1748
2024-11-12 19:36:15.849 INFO: Epoch 222: loss=0.1741
2024-11-12 19:37:00.373 INFO: Epoch 224: loss=0.1734
2024-11-12 19:37:45.087 INFO: Epoch 226: loss=0.1718
2024-11-12 19:38:29.710 INFO: Epoch 228: loss=0.1701
2024-11-12 19:39:14.305 INFO: Epoch 230: loss=0.1703
2024-11-12 19:39:58.800 INFO: Epoch 232: loss=0.1694
2024-11-12 19:40:43.420 INFO: Epoch 234: loss=0.1682
2024-11-12 19:41:28.023 INFO: Epoch 236: loss=0.1672
2024-11-12 19:42:12.573 INFO: Epoch 238: loss=0.1671
2024-11-12 19:42:57.136 INFO: Epoch 240: loss=0.1660
2024-11-12 19:43:41.676 INFO: Epoch 242: loss=0.1654
2024-11-12 19:44:26.286 INFO: Epoch 244: loss=0.1643
2024-11-12 19:45:10.862 INFO: Epoch 246: loss=0.1627
2024-11-12 19:45:55.442 INFO: Epoch 248: loss=0.1631
2024-11-12 19:46:39.995 INFO: Epoch 250: loss=0.1621
2024-11-12 19:47:24.594 INFO: Epoch 252: loss=0.1620
2024-11-12 19:48:09.193 INFO: Epoch 254: loss=0.1615
2024-11-12 19:48:53.739 INFO: Epoch 256: loss=0.1607
2024-11-12 19:49:38.373 INFO: Epoch 258: loss=0.1604
2024-11-12 19:50:23.018 INFO: Epoch 260: loss=0.1619
2024-11-12 19:51:07.581 INFO: Epoch 262: loss=0.1607
2024-11-12 19:51:52.146 INFO: Epoch 264: loss=0.1598
2024-11-12 19:52:36.744 INFO: Epoch 266: loss=0.1592
2024-11-12 19:53:21.331 INFO: Epoch 268: loss=0.1592
2024-11-12 19:54:05.834 INFO: Epoch 270: loss=0.1585
2024-11-12 19:54:50.612 INFO: Epoch 272: loss=0.1580
2024-11-12 19:55:35.228 INFO: Epoch 274: loss=0.1575
2024-11-12 19:56:19.795 INFO: Epoch 276: loss=0.1559
2024-11-12 19:57:04.366 INFO: Epoch 278: loss=0.1560
2024-11-12 19:57:49.005 INFO: Epoch 280: loss=0.1544
2024-11-12 19:58:33.548 INFO: Epoch 282: loss=0.1551
2024-11-12 19:59:17.998 INFO: Epoch 284: loss=0.1558
2024-11-12 20:00:02.471 INFO: Epoch 286: loss=0.1545
2024-11-12 20:00:46.946 INFO: Epoch 288: loss=0.1536
2024-11-12 20:01:31.174 INFO: Epoch 290: loss=0.1537
2024-11-12 20:02:15.637 INFO: Epoch 292: loss=0.1525
2024-11-12 20:03:00.183 INFO: Epoch 294: loss=0.1518
2024-11-12 20:03:44.720 INFO: Epoch 296: loss=0.1516
2024-11-12 20:04:29.291 INFO: Epoch 298: loss=0.1511
2024-11-12 20:05:13.897 INFO: Epoch 300: loss=0.1506
2024-11-12 20:05:58.569 INFO: Epoch 302: loss=0.1506
2024-11-12 20:06:43.182 INFO: Epoch 304: loss=0.1492
2024-11-12 20:07:27.770 INFO: Epoch 306: loss=0.1495
2024-11-12 20:08:12.314 INFO: Epoch 308: loss=0.1489
2024-11-12 20:08:57.657 INFO: Epoch 310: loss=0.1489
2024-11-12 20:09:42.245 INFO: Epoch 312: loss=0.1481
2024-11-12 20:10:26.821 INFO: Epoch 314: loss=0.1477
2024-11-12 20:11:11.432 INFO: Epoch 316: loss=0.1474
2024-11-12 20:11:55.973 INFO: Epoch 318: loss=0.1469
2024-11-12 20:12:40.575 INFO: Epoch 320: loss=0.1475
2024-11-12 20:13:25.085 INFO: Epoch 322: loss=0.1464
2024-11-12 20:14:09.659 INFO: Epoch 324: loss=0.1464
2024-11-12 20:14:54.309 INFO: Epoch 326: loss=0.1458
2024-11-12 20:15:38.928 INFO: Epoch 328: loss=0.1450
2024-11-12 20:16:23.512 INFO: Epoch 330: loss=0.1453
2024-11-12 20:17:08.030 INFO: Epoch 332: loss=0.1442
2024-11-12 20:17:52.617 INFO: Epoch 334: loss=0.1434
2024-11-12 20:18:37.174 INFO: Epoch 336: loss=0.1429
2024-11-12 20:19:21.765 INFO: Epoch 338: loss=0.1424
2024-11-12 20:20:06.368 INFO: Epoch 340: loss=0.1420
2024-11-12 20:20:50.931 INFO: Epoch 342: loss=0.1423
2024-11-12 20:21:35.463 INFO: Epoch 344: loss=0.1429
2024-11-12 20:22:19.957 INFO: Epoch 346: loss=0.1419
2024-11-12 20:23:04.525 INFO: Epoch 348: loss=0.1414
2024-11-12 20:23:49.046 INFO: Epoch 350: loss=0.1411
2024-11-12 20:24:33.636 INFO: Epoch 352: loss=0.1410
2024-11-12 20:25:18.210 INFO: Epoch 354: loss=0.1406
2024-11-12 20:26:02.726 INFO: Epoch 356: loss=0.1398
2024-11-12 20:26:47.294 INFO: Epoch 358: loss=0.1412
2024-11-12 20:27:31.776 INFO: Epoch 360: loss=0.1401
2024-11-12 20:28:16.249 INFO: Epoch 362: loss=0.1385
2024-11-12 20:29:00.837 INFO: Epoch 364: loss=0.1388
2024-11-12 20:29:45.353 INFO: Epoch 366: loss=0.1387
2024-11-12 20:30:29.855 INFO: Epoch 368: loss=0.1384
2024-11-12 20:31:14.436 INFO: Epoch 370: loss=0.1382
2024-11-12 20:31:59.039 INFO: Epoch 372: loss=0.1377
2024-11-12 20:32:43.599 INFO: Epoch 374: loss=0.1379
2024-11-12 20:33:28.100 INFO: Epoch 376: loss=0.1380
2024-11-12 20:34:12.635 INFO: Epoch 378: loss=0.1375
2024-11-12 20:34:57.195 INFO: Epoch 380: loss=0.1367
2024-11-12 20:35:41.759 INFO: Epoch 382: loss=0.1358
2024-11-12 20:36:26.266 INFO: Epoch 384: loss=0.1367
2024-11-12 20:37:10.768 INFO: Epoch 386: loss=0.1360
2024-11-12 20:37:55.317 INFO: Epoch 388: loss=0.1357
2024-11-12 20:38:39.911 INFO: Epoch 390: loss=0.1356
2024-11-12 20:39:24.500 INFO: Epoch 392: loss=0.1354
2024-11-12 20:40:09.106 INFO: Epoch 394: loss=0.1353
2024-11-12 20:40:53.673 INFO: Epoch 396: loss=0.1344
2024-11-12 20:41:38.237 INFO: Epoch 398: loss=0.1345
2024-11-12 20:42:22.783 INFO: Epoch 400: loss=0.1345
2024-11-12 20:43:07.282 INFO: Epoch 402: loss=0.1340
2024-11-12 20:43:51.845 INFO: Epoch 404: loss=0.1334
2024-11-12 20:44:36.452 INFO: Epoch 406: loss=0.1343
2024-11-12 20:45:21.028 INFO: Epoch 408: loss=0.1329
2024-11-12 20:46:05.600 INFO: Epoch 410: loss=0.1322
2024-11-12 20:46:50.217 INFO: Epoch 412: loss=0.1332
2024-11-12 20:47:34.720 INFO: Epoch 414: loss=0.1322
2024-11-12 20:48:19.375 INFO: Epoch 416: loss=0.1310
2024-11-12 20:49:03.964 INFO: Epoch 418: loss=0.1315
2024-11-12 20:49:48.518 INFO: Epoch 420: loss=0.1315
2024-11-12 20:50:33.061 INFO: Epoch 422: loss=0.1315
2024-11-12 20:51:17.638 INFO: Epoch 424: loss=0.1316
2024-11-12 20:52:02.145 INFO: Epoch 426: loss=0.1307
2024-11-12 20:52:46.757 INFO: Epoch 428: loss=0.1307
2024-11-12 20:53:31.207 INFO: Epoch 430: loss=0.1314
2024-11-12 20:54:15.727 INFO: Epoch 432: loss=0.1305
2024-11-12 20:55:00.257 INFO: Epoch 434: loss=0.1304
2024-11-12 20:55:44.859 INFO: Epoch 436: loss=0.1300
2024-11-12 20:56:29.442 INFO: Epoch 438: loss=0.1295
2024-11-12 20:57:13.945 INFO: Epoch 440: loss=0.1299
2024-11-12 20:57:58.498 INFO: Epoch 442: loss=0.1292
2024-11-13 11:33:08.658 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=True)
2024-11-13 11:33:08.878 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 11:33:08.878 INFO: Loading 3BPA dataset
2024-11-13 11:33:12.674 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 11:33:12.676 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 11:33:13.271 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 11:33:13.312 INFO: Average number of neighbors: 16.712
2024-11-13 11:33:13.312 INFO: Building model
2024-11-13 11:33:14.539 INFO: Loading checkpoint: checkpoints/gaunt-3bpa_run-6_epoch-442.pt
2024-11-13 11:33:14.585 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 11:33:14.586 INFO: Number of parameters: 2803984
2024-11-13 11:33:14.586 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 11:33:14.586 INFO: Started training
2024-11-13 11:33:47.300 INFO: Epoch 442: loss=0.1313
2024-11-13 11:34:34.000 INFO: Epoch 444: loss=0.1305
2024-11-13 11:35:06.172 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 11:35:06.387 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 11:35:06.387 INFO: Loading 3BPA dataset
2024-11-13 11:35:10.232 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 11:35:10.234 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 11:35:11.079 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 11:35:11.135 INFO: Average number of neighbors: 16.712
2024-11-13 11:35:11.135 INFO: Building model
2024-11-13 11:35:12.348 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 11:35:12.350 INFO: Number of parameters: 2803984
2024-11-13 11:35:12.350 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 11:35:12.350 INFO: Started training
2024-11-13 11:35:44.085 INFO: Epoch 0: loss=44.7028
2024-11-13 11:36:49.807 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 11:36:50.015 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 11:36:50.015 INFO: Loading 3BPA dataset
2024-11-13 11:36:54.111 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 11:36:54.113 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 11:36:54.751 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 11:36:54.795 INFO: Average number of neighbors: 16.712
2024-11-13 11:36:54.795 INFO: Building model
2024-11-13 11:39:01.222 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 11:39:01.436 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 11:39:01.436 INFO: Loading 3BPA dataset
2024-11-13 11:39:05.218 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 11:39:05.220 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 11:39:06.110 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 11:39:06.165 INFO: Average number of neighbors: 16.712
2024-11-13 11:39:06.165 INFO: Building model
2024-11-13 11:39:07.365 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 11:39:07.366 INFO: Number of parameters: 2803984
2024-11-13 11:39:07.366 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 11:39:07.366 INFO: Started training
2024-11-13 14:54:48.314 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 14:54:48.535 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 14:54:48.535 INFO: Loading 3BPA dataset
2024-11-13 14:54:52.720 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 14:54:52.722 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 14:54:53.619 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 14:54:53.676 INFO: Average number of neighbors: 16.712
2024-11-13 14:54:53.676 INFO: Building model
2024-11-13 14:54:54.893 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 14:54:54.895 INFO: Number of parameters: 2803984
2024-11-13 14:54:54.895 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 14:54:54.895 INFO: Started training
2024-11-13 14:57:55.316 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 14:57:55.528 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 14:57:55.528 INFO: Loading 3BPA dataset
2024-11-13 14:57:59.334 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 14:57:59.336 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 14:57:59.934 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 14:57:59.973 INFO: Average number of neighbors: 16.712
2024-11-13 14:57:59.973 INFO: Building model
2024-11-13 14:58:01.193 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 14:58:01.195 INFO: Number of parameters: 2803984
2024-11-13 14:58:01.195 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 14:58:01.195 INFO: Started training
2024-11-13 14:58:23.061 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 14:58:23.272 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 14:58:23.272 INFO: Loading 3BPA dataset
2024-11-13 14:58:27.063 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 14:58:27.065 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 14:58:27.731 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 14:58:27.770 INFO: Average number of neighbors: 16.712
2024-11-13 14:58:27.770 INFO: Building model
2024-11-13 14:58:28.984 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 14:58:28.986 INFO: Number of parameters: 2803984
2024-11-13 14:58:28.986 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 14:58:28.986 INFO: Started training
2024-11-13 14:58:42.106 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 14:58:42.323 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 14:58:42.324 INFO: Loading 3BPA dataset
2024-11-13 14:58:46.499 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 14:58:46.501 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 14:58:47.392 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 14:58:47.447 INFO: Average number of neighbors: 16.712
2024-11-13 14:58:47.448 INFO: Building model
2024-11-13 14:58:48.654 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 14:58:48.655 INFO: Number of parameters: 2803984
2024-11-13 14:58:48.655 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 14:58:48.656 INFO: Started training
2024-11-13 14:59:34.805 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 14:59:35.014 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 14:59:35.014 INFO: Loading 3BPA dataset
2024-11-13 14:59:39.086 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 14:59:39.088 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 14:59:39.677 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 14:59:39.717 INFO: Average number of neighbors: 16.712
2024-11-13 14:59:39.717 INFO: Building model
2024-11-13 14:59:40.922 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 14:59:40.924 INFO: Number of parameters: 2803984
2024-11-13 14:59:40.924 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 14:59:40.924 INFO: Started training
2024-11-13 15:06:23.585 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 15:06:23.800 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 15:06:23.800 INFO: Loading 3BPA dataset
2024-11-13 15:06:27.915 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 15:06:27.917 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 15:06:28.810 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 15:06:28.870 INFO: Average number of neighbors: 16.712
2024-11-13 15:06:28.870 INFO: Building model
2024-11-13 15:06:59.533 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 15:06:59.754 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 15:06:59.754 INFO: Loading 3BPA dataset
2024-11-13 15:07:03.658 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 15:07:03.660 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 15:07:04.252 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 15:07:04.293 INFO: Average number of neighbors: 16.712
2024-11-13 15:07:04.293 INFO: Building model
2024-11-13 15:07:05.522 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 15:07:05.524 INFO: Number of parameters: 2803984
2024-11-13 15:07:05.524 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 15:07:05.524 INFO: Started training
2024-11-13 15:08:12.637 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 15:08:12.848 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 15:08:12.848 INFO: Loading 3BPA dataset
2024-11-13 15:08:16.950 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 15:08:16.952 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 15:08:17.848 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 15:08:17.907 INFO: Average number of neighbors: 16.712
2024-11-13 15:08:17.907 INFO: Building model
2024-11-13 15:08:19.123 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 15:08:19.124 INFO: Number of parameters: 2803984
2024-11-13 15:08:19.124 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 15:08:19.124 INFO: Started training
2024-11-13 15:08:54.475 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 15:08:54.688 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 15:08:54.688 INFO: Loading 3BPA dataset
2024-11-13 15:08:58.465 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 15:08:58.467 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 15:08:59.055 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 15:08:59.093 INFO: Average number of neighbors: 16.712
2024-11-13 15:08:59.093 INFO: Building model
2024-11-13 15:09:00.312 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 15:09:00.314 INFO: Number of parameters: 2803984
2024-11-13 15:09:00.314 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 15:09:00.314 INFO: Started training
2024-11-13 15:09:44.660 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 15:09:44.884 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 15:09:44.884 INFO: Loading 3BPA dataset
2024-11-13 15:09:48.871 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 15:09:48.873 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 15:09:49.767 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 15:09:49.823 INFO: Average number of neighbors: 16.712
2024-11-13 15:09:49.823 INFO: Building model
2024-11-13 15:09:51.060 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 15:09:51.062 INFO: Number of parameters: 2803984
2024-11-13 15:09:51.062 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 15:09:51.063 INFO: Started training
2024-11-13 15:10:04.046 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 15:10:04.260 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 15:10:04.260 INFO: Loading 3BPA dataset
2024-11-13 15:10:08.036 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 15:10:08.038 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 15:10:08.927 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 15:10:08.983 INFO: Average number of neighbors: 16.712
2024-11-13 15:10:08.983 INFO: Building model
2024-11-13 15:10:10.193 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 15:10:10.195 INFO: Number of parameters: 2803984
2024-11-13 15:10:10.195 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 15:10:10.195 INFO: Started training
2024-11-13 17:49:53.555 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 17:49:53.762 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 17:49:53.762 INFO: Loading 3BPA dataset
2024-11-13 17:49:57.536 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 17:49:57.538 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 17:49:58.428 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 17:49:58.483 INFO: Average number of neighbors: 16.712
2024-11-13 17:49:58.483 INFO: Building model
2024-11-13 17:49:59.707 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 17:49:59.709 INFO: Number of parameters: 2803984
2024-11-13 17:49:59.709 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 17:49:59.709 INFO: Started training
2024-11-13 17:50:31.560 INFO: Epoch 0: loss=44.7028
2024-11-13 17:53:03.184 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 17:53:03.394 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 17:53:03.395 INFO: Loading 3BPA dataset
2024-11-13 17:53:07.500 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 17:53:07.503 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 17:53:08.353 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 17:53:08.393 INFO: Average number of neighbors: 16.712
2024-11-13 17:53:08.393 INFO: Building model
2024-11-13 17:53:09.607 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 17:53:09.608 INFO: Number of parameters: 2803984
2024-11-13 17:53:09.608 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 17:53:09.608 INFO: Started training
2024-11-13 17:53:41.562 INFO: Epoch 0: loss=44.7028
2024-11-13 17:54:26.341 INFO: Epoch 2: loss=8.3191
2024-11-13 17:55:11.027 INFO: Epoch 4: loss=4.9052
2024-11-13 17:55:55.791 INFO: Epoch 6: loss=3.5296
2024-11-13 17:56:40.540 INFO: Epoch 8: loss=2.7335
2024-11-13 17:57:25.260 INFO: Epoch 10: loss=2.2178
2024-11-13 17:58:09.968 INFO: Epoch 12: loss=1.8776
2024-11-13 17:58:54.629 INFO: Epoch 14: loss=1.6277
2024-11-13 18:00:16.236 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:00:16.444 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:00:16.444 INFO: Loading 3BPA dataset
2024-11-13 18:00:20.375 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:00:20.377 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:00:20.976 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:00:21.014 INFO: Average number of neighbors: 16.712
2024-11-13 18:00:21.014 INFO: Building model
2024-11-13 18:01:00.199 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:01:00.414 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:01:00.414 INFO: Loading 3BPA dataset
2024-11-13 18:01:04.185 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:01:04.187 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:01:04.781 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:01:04.821 INFO: Average number of neighbors: 16.712
2024-11-13 18:01:04.822 INFO: Building model
2024-11-13 18:01:06.148 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=6x6 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=6x6 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x2 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x2 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 18:01:06.150 INFO: Number of parameters: 2803984
2024-11-13 18:01:06.150 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 18:01:06.150 INFO: Started training
2024-11-13 18:01:59.705 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:01:59.914 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:01:59.915 INFO: Loading 3BPA dataset
2024-11-13 18:02:03.976 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:02:03.979 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:02:04.875 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:02:04.932 INFO: Average number of neighbors: 16.712
2024-11-13 18:02:04.932 INFO: Building model
2024-11-13 18:02:06.294 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=6x6 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=6x6 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x2 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x2 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 18:02:06.296 INFO: Number of parameters: 2803984
2024-11-13 18:02:06.296 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 18:02:06.296 INFO: Started training
2024-11-13 18:02:25.681 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:02:25.894 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:02:25.894 INFO: Loading 3BPA dataset
2024-11-13 18:02:30.027 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:02:30.029 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:02:30.823 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:02:30.865 INFO: Average number of neighbors: 16.712
2024-11-13 18:02:30.865 INFO: Building model
2024-11-13 18:02:32.191 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=6x6 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=6x6 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x2 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x2 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 18:02:32.193 INFO: Number of parameters: 2803984
2024-11-13 18:02:32.193 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 18:02:32.193 INFO: Started training
2024-11-13 18:10:00.166 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:10:00.382 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:10:00.382 INFO: Loading 3BPA dataset
2024-11-13 18:10:04.293 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:10:04.295 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:10:05.181 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:10:05.237 INFO: Average number of neighbors: 16.712
2024-11-13 18:10:05.237 INFO: Building model
2024-11-13 18:10:06.572 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=6x6 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=6x6 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x2 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x2 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 18:10:06.574 INFO: Number of parameters: 2803984
2024-11-13 18:10:06.574 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 18:10:06.574 INFO: Started training
2024-11-13 18:11:54.158 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:11:54.366 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:11:54.367 INFO: Loading 3BPA dataset
2024-11-13 18:11:58.119 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:11:58.121 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:11:58.711 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:11:58.750 INFO: Average number of neighbors: 16.712
2024-11-13 18:11:58.750 INFO: Building model
2024-11-13 18:12:10.699 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:12:10.908 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:12:10.908 INFO: Loading 3BPA dataset
2024-11-13 18:12:15.102 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:12:15.104 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:12:15.994 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:12:16.050 INFO: Average number of neighbors: 16.712
2024-11-13 18:12:16.050 INFO: Building model
2024-11-13 18:12:59.145 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:12:59.364 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:12:59.364 INFO: Loading 3BPA dataset
2024-11-13 18:13:03.172 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:13:03.174 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:13:03.775 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:13:03.814 INFO: Average number of neighbors: 16.712
2024-11-13 18:13:03.814 INFO: Building model
2024-11-13 18:13:05.145 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=6x6 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=6x6 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x2 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x2 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 18:13:05.146 INFO: Number of parameters: 2803984
2024-11-13 18:13:05.146 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 18:13:05.146 INFO: Started training
2024-11-13 18:14:33.524 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:14:33.740 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:14:33.740 INFO: Loading 3BPA dataset
2024-11-13 18:14:37.490 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:14:37.491 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:14:38.383 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:14:38.439 INFO: Average number of neighbors: 16.712
2024-11-13 18:14:38.439 INFO: Building model
2024-11-13 18:14:39.759 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=6x6 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=6x6 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x2 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x2 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 18:14:39.761 INFO: Number of parameters: 2803984
2024-11-13 18:14:39.761 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 18:14:39.761 INFO: Started training
2024-11-13 18:18:30.611 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:18:30.827 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:18:30.827 INFO: Loading 3BPA dataset
2024-11-13 18:18:34.656 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:18:34.658 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:18:35.539 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:18:35.594 INFO: Average number of neighbors: 16.712
2024-11-13 18:18:35.594 INFO: Building model
2024-11-13 18:18:36.910 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=6x6 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=6x6 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x2 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x2 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 18:18:36.912 INFO: Number of parameters: 2803984
2024-11-13 18:18:36.912 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 18:18:36.912 INFO: Started training
2024-11-13 18:22:34.136 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:22:34.342 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:22:34.342 INFO: Loading 3BPA dataset
2024-11-13 18:22:38.109 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:22:38.111 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:22:38.711 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:22:38.750 INFO: Average number of neighbors: 16.712
2024-11-13 18:22:38.750 INFO: Building model
2024-11-13 18:22:54.911 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:22:55.132 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:22:55.132 INFO: Loading 3BPA dataset
2024-11-13 18:22:58.937 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:22:58.939 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:22:59.548 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:22:59.598 INFO: Average number of neighbors: 16.712
2024-11-13 18:22:59.598 INFO: Building model
2024-11-13 18:23:00.838 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 18:23:00.840 INFO: Number of parameters: 2803984
2024-11-13 18:23:00.840 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 18:23:00.840 INFO: Started training
2024-11-13 18:24:00.267 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:24:00.483 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:24:00.483 INFO: Loading 3BPA dataset
2024-11-13 18:24:04.357 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:24:04.359 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:24:05.245 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:24:05.302 INFO: Average number of neighbors: 16.712
2024-11-13 18:24:05.302 INFO: Building model
2024-11-13 18:24:06.523 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 18:24:06.525 INFO: Number of parameters: 2803984
2024-11-13 18:24:06.525 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 18:24:06.525 INFO: Started training
2024-11-13 18:24:28.018 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:24:28.235 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:24:28.235 INFO: Loading 3BPA dataset
2024-11-13 18:24:32.155 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:24:32.157 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:24:32.760 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:24:32.800 INFO: Average number of neighbors: 16.712
2024-11-13 18:24:32.800 INFO: Building model
2024-11-13 18:24:34.121 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=6x6 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=6x6 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x2 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x2 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 18:24:34.123 INFO: Number of parameters: 2803984
2024-11-13 18:24:34.123 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 18:24:34.123 INFO: Started training
2024-11-13 18:26:13.308 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:26:13.516 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:26:13.517 INFO: Loading 3BPA dataset
2024-11-13 18:26:17.555 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:26:17.557 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:26:18.449 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:26:18.508 INFO: Average number of neighbors: 16.712
2024-11-13 18:26:18.508 INFO: Building model
2024-11-13 18:26:19.837 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=6x6 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=6x6 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x2 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x2 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 18:26:19.839 INFO: Number of parameters: 2803984
2024-11-13 18:26:19.839 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 18:26:19.839 INFO: Started training
2024-11-13 18:27:13.574 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:27:13.784 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:27:13.784 INFO: Loading 3BPA dataset
2024-11-13 18:27:17.558 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:27:17.560 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:27:18.451 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:27:18.506 INFO: Average number of neighbors: 16.712
2024-11-13 18:27:18.506 INFO: Building model
2024-11-13 18:27:19.827 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=6x6 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=6x6 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x2 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x2 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 18:27:19.829 INFO: Number of parameters: 2803984
2024-11-13 18:27:19.829 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 18:27:19.829 INFO: Started training
2024-11-13 18:28:06.922 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:28:07.140 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:28:07.140 INFO: Loading 3BPA dataset
2024-11-13 18:28:11.228 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:28:11.231 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:28:11.833 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:28:11.875 INFO: Average number of neighbors: 16.712
2024-11-13 18:28:11.875 INFO: Building model
2024-11-13 18:28:13.213 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=6x6 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=6x6 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x2 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x2 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 18:28:13.215 INFO: Number of parameters: 2803984
2024-11-13 18:28:13.215 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 18:28:13.215 INFO: Started training
2024-11-13 18:28:30.338 INFO: Epoch 0: loss=97.5411
2024-11-13 18:28:46.415 INFO: Epoch 2: loss=25.3563
2024-11-13 18:29:02.653 INFO: Epoch 4: loss=15.6653
2024-11-13 18:29:18.558 INFO: Epoch 6: loss=11.3249
2024-11-13 18:29:34.514 INFO: Epoch 8: loss=9.2394
2024-11-13 18:29:50.485 INFO: Epoch 10: loss=7.8179
2024-11-13 18:30:06.476 INFO: Epoch 12: loss=6.7588
2024-11-13 18:30:22.471 INFO: Epoch 14: loss=6.0521
2024-11-13 18:30:38.540 INFO: Epoch 16: loss=5.5589
2024-11-13 18:30:54.560 INFO: Epoch 18: loss=5.1455
2024-11-13 18:31:10.588 INFO: Epoch 20: loss=4.8250
2024-11-13 18:31:26.628 INFO: Epoch 22: loss=4.5218
2024-11-13 18:31:42.659 INFO: Epoch 24: loss=4.2533
2024-11-13 18:31:58.666 INFO: Epoch 26: loss=4.0362
2024-11-13 18:32:14.680 INFO: Epoch 28: loss=3.8978
2024-11-13 18:32:30.696 INFO: Epoch 30: loss=3.6907
2024-11-13 18:32:46.715 INFO: Epoch 32: loss=3.5167
2024-11-13 18:33:02.713 INFO: Epoch 34: loss=3.3598
2024-11-13 18:33:18.720 INFO: Epoch 36: loss=3.2676
2024-11-13 18:33:34.733 INFO: Epoch 38: loss=3.1543
2024-11-13 18:33:50.746 INFO: Epoch 40: loss=3.0498
2024-11-13 18:34:06.766 INFO: Epoch 42: loss=2.9811
2024-11-13 18:34:22.792 INFO: Epoch 44: loss=2.9206
2024-11-13 18:34:38.812 INFO: Epoch 46: loss=2.8512
2024-11-13 18:34:54.829 INFO: Epoch 48: loss=2.7654
2024-11-13 18:35:10.850 INFO: Epoch 50: loss=2.6918
2024-11-13 18:35:26.894 INFO: Epoch 52: loss=2.6603
2024-11-13 18:35:42.911 INFO: Epoch 54: loss=2.6297
2024-11-13 18:35:58.929 INFO: Epoch 56: loss=2.5540
2024-11-13 18:36:14.953 INFO: Epoch 58: loss=2.5110
2024-11-13 18:36:30.957 INFO: Epoch 60: loss=2.4707
2024-11-13 18:36:46.967 INFO: Epoch 62: loss=2.4177
2024-11-13 18:37:02.993 INFO: Epoch 64: loss=2.3920
2024-11-13 18:37:18.985 INFO: Epoch 66: loss=2.3457
2024-11-13 18:37:34.981 INFO: Epoch 68: loss=2.2973
2024-11-13 18:37:50.969 INFO: Epoch 70: loss=2.2758
2024-11-13 18:38:06.967 INFO: Epoch 72: loss=2.2277
2024-11-13 18:38:22.961 INFO: Epoch 74: loss=2.2055
2024-11-13 18:38:38.945 INFO: Epoch 76: loss=2.1768
2024-11-13 18:38:54.940 INFO: Epoch 78: loss=2.1562
2024-11-13 18:39:10.927 INFO: Epoch 80: loss=2.1333
2024-11-13 18:39:26.921 INFO: Epoch 82: loss=2.0836
2024-11-13 18:39:42.893 INFO: Epoch 84: loss=2.0837
2024-11-13 18:39:58.822 INFO: Epoch 86: loss=2.0536
2024-11-13 18:40:14.793 INFO: Epoch 88: loss=2.0277
2024-11-13 18:40:30.778 INFO: Epoch 90: loss=2.0028
2024-11-13 18:41:45.555 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:41:45.767 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:41:45.767 INFO: Loading 3BPA dataset
2024-11-13 18:41:49.668 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:41:49.670 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:41:50.557 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:41:50.612 INFO: Average number of neighbors: 16.712
2024-11-13 18:41:50.612 INFO: Building model
2024-11-13 18:41:51.988 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=12x12 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=12x12 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=4x4 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=4x4 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 18:41:51.989 INFO: Number of parameters: 2803984
2024-11-13 18:41:51.989 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 18:41:51.989 INFO: Started training
2024-11-13 18:42:09.180 INFO: Epoch 0: loss=97.4923
2024-11-13 18:42:25.541 INFO: Epoch 2: loss=25.2207
2024-11-13 18:42:41.966 INFO: Epoch 4: loss=15.5825
2024-11-13 18:42:58.439 INFO: Epoch 6: loss=11.2366
2024-11-13 18:43:14.952 INFO: Epoch 8: loss=9.0482
2024-11-13 18:43:31.464 INFO: Epoch 10: loss=7.5382
2024-11-13 18:43:48.012 INFO: Epoch 12: loss=6.4599
2024-11-13 18:44:04.548 INFO: Epoch 14: loss=5.7319
2024-11-13 18:44:21.087 INFO: Epoch 16: loss=5.1844
2024-11-13 18:44:39.951 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:44:40.174 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:44:40.175 INFO: Loading 3BPA dataset
2024-11-13 18:44:44.050 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:44:44.053 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:44:44.647 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:44:44.687 INFO: Average number of neighbors: 16.712
2024-11-13 18:44:44.687 INFO: Building model
2024-11-13 18:52:31.368 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-13 18:52:31.589 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-13 18:52:31.589 INFO: Loading 3BPA dataset
2024-11-13 18:52:35.412 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-13 18:52:35.414 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-13 18:52:35.997 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-13 18:52:36.037 INFO: Average number of neighbors: 16.712
2024-11-13 18:52:36.037 INFO: Building model
2024-11-13 18:52:37.396 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=10x5 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=10x5 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x1 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x1 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-13 18:52:37.398 INFO: Number of parameters: 2803984
2024-11-13 18:52:37.398 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-13 18:52:37.398 INFO: Started training
2024-11-13 18:52:55.563 INFO: Epoch 0: loss=97.4703
2024-11-13 18:53:13.273 INFO: Epoch 2: loss=25.2942
2024-11-13 18:53:31.092 INFO: Epoch 4: loss=15.6650
2024-11-13 18:53:49.079 INFO: Epoch 6: loss=11.1937
2024-11-13 18:54:06.974 INFO: Epoch 8: loss=9.2124
2024-11-13 18:54:24.728 INFO: Epoch 10: loss=7.7234
2024-11-13 18:54:42.494 INFO: Epoch 12: loss=6.6789
2024-11-13 18:55:00.264 INFO: Epoch 14: loss=5.9927
2024-11-13 18:55:18.061 INFO: Epoch 16: loss=5.4626
2024-11-13 18:55:36.011 INFO: Epoch 18: loss=5.0768
2024-11-13 18:55:53.818 INFO: Epoch 20: loss=4.7004
2024-11-13 18:56:11.624 INFO: Epoch 22: loss=4.4167
2024-11-13 18:56:29.441 INFO: Epoch 24: loss=4.1931
2024-11-13 18:56:47.244 INFO: Epoch 26: loss=3.9985
2024-11-13 18:57:05.042 INFO: Epoch 28: loss=3.8461
2024-11-13 18:57:22.903 INFO: Epoch 30: loss=3.6712
2024-11-13 18:57:40.702 INFO: Epoch 32: loss=3.5397
2024-11-13 18:57:58.507 INFO: Epoch 34: loss=3.4019
2024-11-13 18:58:16.328 INFO: Epoch 36: loss=3.3375
2024-11-13 18:58:34.117 INFO: Epoch 38: loss=3.2344
2024-11-13 18:58:51.904 INFO: Epoch 40: loss=3.1413
2024-11-13 18:59:09.669 INFO: Epoch 42: loss=3.0725
2024-11-13 18:59:27.442 INFO: Epoch 44: loss=3.0179
2024-11-13 18:59:45.222 INFO: Epoch 46: loss=2.9472
2024-11-13 19:00:03.009 INFO: Epoch 48: loss=2.8753
2024-11-13 19:00:20.784 INFO: Epoch 50: loss=2.7923
2024-11-13 19:00:38.652 INFO: Epoch 52: loss=2.7560
2024-11-13 19:00:56.442 INFO: Epoch 54: loss=2.7196
2024-11-13 19:01:14.230 INFO: Epoch 56: loss=2.6636
2024-11-13 19:01:32.016 INFO: Epoch 58: loss=2.5977
2024-11-13 19:01:49.812 INFO: Epoch 60: loss=2.5726
2024-11-13 19:02:07.611 INFO: Epoch 62: loss=2.5211
2024-11-13 19:02:25.394 INFO: Epoch 64: loss=2.4977
2024-11-13 19:02:43.149 INFO: Epoch 66: loss=2.4441
2024-11-13 19:03:00.959 INFO: Epoch 68: loss=2.3858
2024-11-13 19:03:18.804 INFO: Epoch 70: loss=2.3623
2024-11-13 19:03:36.637 INFO: Epoch 72: loss=2.3438
2024-11-13 19:03:54.414 INFO: Epoch 74: loss=2.3143
2024-11-13 19:04:12.182 INFO: Epoch 76: loss=2.2936
2024-11-13 19:04:29.947 INFO: Epoch 78: loss=2.2570
2024-11-13 19:04:47.738 INFO: Epoch 80: loss=2.2279
2024-11-13 19:05:05.515 INFO: Epoch 82: loss=2.1963
2024-11-13 19:05:23.278 INFO: Epoch 84: loss=2.1932
2024-11-13 19:05:41.050 INFO: Epoch 86: loss=2.1558
2024-11-13 19:05:58.807 INFO: Epoch 88: loss=2.1084
2024-11-13 19:06:16.557 INFO: Epoch 90: loss=2.0983
2024-11-13 19:06:34.371 INFO: Epoch 92: loss=2.0770
2024-11-13 19:06:52.124 INFO: Epoch 94: loss=2.0773
2024-11-13 19:07:09.910 INFO: Epoch 96: loss=2.0474
2024-11-13 19:07:27.702 INFO: Epoch 98: loss=2.0282
2024-11-13 19:07:45.505 INFO: Epoch 100: loss=2.0196
2024-11-13 19:08:03.292 INFO: Epoch 102: loss=2.0144
2024-11-13 19:08:21.090 INFO: Epoch 104: loss=2.0146
2024-11-13 19:08:38.833 INFO: Epoch 106: loss=2.0031
2024-11-13 19:08:56.604 INFO: Epoch 108: loss=1.9754
2024-11-13 19:09:14.386 INFO: Epoch 110: loss=1.9638
2024-11-13 19:09:32.171 INFO: Epoch 112: loss=1.9646
2024-11-13 19:09:49.909 INFO: Epoch 114: loss=1.9302
2024-11-13 19:10:07.676 INFO: Epoch 116: loss=1.9152
2024-11-13 19:10:25.433 INFO: Epoch 118: loss=1.9054
2024-11-13 19:10:43.192 INFO: Epoch 120: loss=1.8795
2024-11-13 19:11:00.933 INFO: Epoch 122: loss=1.8869
2024-11-13 19:11:18.622 INFO: Epoch 124: loss=1.8719
2024-11-13 19:11:36.374 INFO: Epoch 126: loss=1.8661
2024-11-13 19:11:54.150 INFO: Epoch 128: loss=1.8582
2024-11-13 19:12:11.916 INFO: Epoch 130: loss=1.8571
2024-11-13 19:12:29.669 INFO: Epoch 132: loss=1.8439
2024-11-13 19:12:47.433 INFO: Epoch 134: loss=1.8409
2024-11-13 19:13:05.205 INFO: Epoch 136: loss=1.8358
2024-11-13 19:13:23.263 INFO: Epoch 138: loss=1.8314
2024-11-13 19:13:41.203 INFO: Epoch 140: loss=1.8166
2024-11-13 19:13:59.140 INFO: Epoch 142: loss=1.7977
2024-11-13 19:14:17.097 INFO: Epoch 144: loss=1.7936
2024-11-13 19:14:35.037 INFO: Epoch 146: loss=1.7954
2024-11-13 19:14:52.911 INFO: Epoch 148: loss=1.8021
2024-11-13 19:15:10.840 INFO: Epoch 150: loss=1.7864
2024-11-13 19:15:28.792 INFO: Epoch 152: loss=1.7904
2024-11-13 19:15:46.675 INFO: Epoch 154: loss=1.7850
2024-11-13 19:16:04.596 INFO: Epoch 156: loss=1.7859
2024-11-13 19:16:22.520 INFO: Epoch 158: loss=1.7801
2024-11-13 19:16:40.453 INFO: Epoch 160: loss=1.7636
2024-11-13 19:16:58.387 INFO: Epoch 162: loss=1.7647
2024-11-13 19:17:16.280 INFO: Epoch 164: loss=1.7579
2024-11-13 19:17:34.218 INFO: Epoch 166: loss=1.7584
2024-11-13 19:17:52.087 INFO: Epoch 168: loss=1.7578
2024-11-13 19:18:09.998 INFO: Epoch 170: loss=1.7477
2024-11-13 19:18:27.890 INFO: Epoch 172: loss=1.7460
2024-11-13 19:18:45.791 INFO: Epoch 174: loss=1.7374
2024-11-13 19:19:03.708 INFO: Epoch 176: loss=1.7424
2024-11-13 19:19:21.575 INFO: Epoch 178: loss=1.7261
2024-11-13 19:19:39.492 INFO: Epoch 180: loss=1.7206
2024-11-13 19:19:57.400 INFO: Epoch 182: loss=1.7244
2024-11-13 19:20:15.248 INFO: Epoch 184: loss=1.7282
2024-11-13 19:20:33.099 INFO: Epoch 186: loss=1.7266
2024-11-13 19:20:50.959 INFO: Epoch 188: loss=1.7228
2024-11-13 19:21:08.846 INFO: Epoch 190: loss=1.7068
2024-11-13 19:21:26.784 INFO: Epoch 192: loss=1.7044
2024-11-13 19:21:44.731 INFO: Epoch 194: loss=1.6998
2024-11-13 19:22:02.699 INFO: Epoch 196: loss=1.7041
2024-11-13 19:22:20.608 INFO: Epoch 198: loss=1.6969
2024-11-13 19:22:38.565 INFO: Epoch 200: loss=1.6965
2024-11-13 19:22:56.507 INFO: Epoch 202: loss=1.6900
2024-11-13 19:23:14.417 INFO: Epoch 204: loss=1.7026
2024-11-13 19:23:32.292 INFO: Epoch 206: loss=1.6978
2024-11-13 19:23:50.161 INFO: Epoch 208: loss=1.6974
2024-11-13 19:24:08.043 INFO: Epoch 210: loss=1.6940
2024-11-13 19:24:25.909 INFO: Epoch 212: loss=1.7139
2024-11-13 19:24:43.773 INFO: Epoch 214: loss=1.6982
2024-11-13 19:25:01.636 INFO: Epoch 216: loss=1.6787
2024-11-13 19:25:19.560 INFO: Epoch 218: loss=1.6834
2024-11-13 19:25:37.444 INFO: Epoch 220: loss=1.6875
2024-11-13 19:25:55.334 INFO: Epoch 222: loss=1.6928
2024-11-13 19:26:13.213 INFO: Epoch 224: loss=1.6700
2024-11-13 19:26:31.142 INFO: Epoch 226: loss=1.6640
2024-11-13 19:26:49.051 INFO: Epoch 228: loss=1.6587
2024-11-13 19:27:06.947 INFO: Epoch 230: loss=1.6653
2024-11-13 19:27:24.832 INFO: Epoch 232: loss=1.6724
2024-11-13 19:27:42.692 INFO: Epoch 234: loss=1.6679
2024-11-13 19:28:00.554 INFO: Epoch 236: loss=1.6649
2024-11-13 19:28:18.416 INFO: Epoch 238: loss=1.6671
2024-11-13 19:28:36.286 INFO: Epoch 240: loss=1.6630
2024-11-13 19:28:54.171 INFO: Epoch 242: loss=1.6627
2024-11-13 19:29:12.028 INFO: Epoch 244: loss=1.6737
2024-11-13 19:29:29.889 INFO: Epoch 246: loss=1.6740
2024-11-13 19:29:47.753 INFO: Epoch 248: loss=1.6477
2024-11-13 19:30:05.664 INFO: Epoch 250: loss=1.6538
2024-11-13 19:30:23.515 INFO: Epoch 252: loss=1.6628
2024-11-13 19:30:41.372 INFO: Epoch 254: loss=1.6592
2024-11-13 19:30:59.224 INFO: Epoch 256: loss=1.6547
2024-11-13 19:31:17.094 INFO: Epoch 258: loss=1.6656
2024-11-13 19:31:34.977 INFO: Epoch 260: loss=1.6713
2024-11-13 19:31:52.848 INFO: Epoch 262: loss=1.6709
2024-11-13 19:32:10.728 INFO: Epoch 264: loss=1.6487
2024-11-13 19:32:28.624 INFO: Epoch 266: loss=1.6545
2024-11-13 19:32:46.488 INFO: Epoch 268: loss=1.6540
2024-11-13 19:33:04.356 INFO: Epoch 270: loss=1.6464
2024-11-13 19:33:22.409 INFO: Epoch 272: loss=1.6453
2024-11-13 19:33:40.388 INFO: Epoch 274: loss=1.6489
2024-11-13 19:33:58.346 INFO: Epoch 276: loss=1.6600
2024-11-13 19:34:16.230 INFO: Epoch 278: loss=1.6530
2024-11-13 19:34:34.134 INFO: Epoch 280: loss=1.6464
2024-11-13 19:34:52.004 INFO: Epoch 282: loss=1.6543
2024-11-13 19:35:09.897 INFO: Epoch 284: loss=1.6570
2024-11-13 19:35:27.780 INFO: Epoch 286: loss=1.6501
2024-11-13 19:35:45.648 INFO: Epoch 288: loss=1.6425
2024-11-13 19:36:03.580 INFO: Epoch 290: loss=1.6339
2024-11-13 19:36:21.519 INFO: Epoch 292: loss=1.6367
2024-11-13 19:36:39.404 INFO: Epoch 294: loss=1.6369
2024-11-13 19:36:57.281 INFO: Epoch 296: loss=1.6425
2024-11-13 19:37:15.140 INFO: Epoch 298: loss=1.6291
2024-11-13 19:37:33.060 INFO: Epoch 300: loss=1.6312
2024-11-13 19:37:50.927 INFO: Epoch 302: loss=1.6417
2024-11-13 19:38:08.772 INFO: Epoch 304: loss=1.6385
2024-11-13 19:38:26.627 INFO: Epoch 306: loss=1.6364
2024-11-13 19:38:44.471 INFO: Epoch 308: loss=1.6367
2024-11-13 19:39:02.316 INFO: Epoch 310: loss=1.6411
2024-11-13 19:39:20.163 INFO: Epoch 312: loss=1.6434
2024-11-13 19:39:38.008 INFO: Epoch 314: loss=1.6402
2024-11-13 19:39:55.892 INFO: Epoch 316: loss=1.6390
2024-11-13 19:40:13.763 INFO: Epoch 318: loss=1.6425
2024-11-13 19:40:31.624 INFO: Epoch 320: loss=1.6402
2024-11-13 19:40:49.450 INFO: Epoch 322: loss=1.6301
2024-11-13 19:41:07.315 INFO: Epoch 324: loss=1.6317
2024-11-13 19:41:25.200 INFO: Epoch 326: loss=1.6378
2024-11-13 19:41:43.070 INFO: Epoch 328: loss=1.6329
2024-11-13 19:42:00.928 INFO: Epoch 330: loss=1.6210
2024-11-13 19:42:18.840 INFO: Epoch 332: loss=1.6274
2024-11-13 19:42:36.714 INFO: Epoch 334: loss=1.6252
2024-11-13 19:42:54.588 INFO: Epoch 336: loss=1.6272
2024-11-13 19:43:12.464 INFO: Epoch 338: loss=1.6174
2024-11-13 19:43:30.364 INFO: Epoch 340: loss=1.6255
2024-11-13 19:43:48.383 INFO: Epoch 342: loss=1.6367
2024-11-13 19:44:06.269 INFO: Epoch 344: loss=1.6383
2024-11-13 19:44:24.160 INFO: Epoch 346: loss=1.6384
2024-11-13 19:44:42.041 INFO: Epoch 348: loss=1.6420
2024-11-13 19:44:59.930 INFO: Epoch 350: loss=1.6462
2024-11-13 19:45:17.808 INFO: Epoch 352: loss=1.6428
2024-11-13 19:45:35.696 INFO: Epoch 354: loss=1.6363
2024-11-13 19:45:53.593 INFO: Epoch 356: loss=1.6352
2024-11-13 19:46:11.512 INFO: Epoch 358: loss=1.6390
2024-11-13 19:46:29.434 INFO: Epoch 360: loss=1.6336
2024-11-13 19:46:47.330 INFO: Epoch 362: loss=1.6277
2024-11-13 19:47:05.222 INFO: Epoch 364: loss=1.6338
2024-11-13 19:47:23.136 INFO: Epoch 366: loss=1.6374
2024-11-13 19:47:41.024 INFO: Epoch 368: loss=1.6453
2024-11-13 19:47:58.923 INFO: Epoch 370: loss=1.6430
2024-11-13 19:48:16.799 INFO: Epoch 372: loss=1.6496
2024-11-13 19:48:34.696 INFO: Epoch 374: loss=1.6325
2024-11-13 19:48:52.580 INFO: Epoch 376: loss=1.6275
2024-11-13 19:49:10.693 INFO: Epoch 378: loss=1.6424
2024-11-13 19:49:28.762 INFO: Epoch 380: loss=1.6308
2024-11-13 19:49:46.679 INFO: Epoch 382: loss=1.6386
2024-11-13 19:50:04.580 INFO: Epoch 384: loss=1.6371
2024-11-13 19:50:22.477 INFO: Epoch 386: loss=1.6324
2024-11-13 19:50:40.368 INFO: Epoch 388: loss=1.6421
2024-11-13 19:50:58.230 INFO: Epoch 390: loss=1.6479
2024-11-13 19:51:16.091 INFO: Epoch 392: loss=1.6487
2024-11-13 19:51:33.947 INFO: Epoch 394: loss=1.6565
2024-11-13 19:51:51.799 INFO: Epoch 396: loss=1.6644
2024-11-13 19:52:09.629 INFO: Epoch 398: loss=1.6631
2024-11-13 19:52:27.487 INFO: Epoch 400: loss=1.6674
2024-11-13 19:52:45.346 INFO: Epoch 402: loss=1.6622
2024-11-13 19:53:03.200 INFO: Epoch 404: loss=1.6663
2024-11-13 19:53:21.061 INFO: Epoch 406: loss=1.6676
2024-11-13 19:53:38.935 INFO: Epoch 408: loss=1.6637
2024-11-13 19:53:56.869 INFO: Epoch 410: loss=1.6696
2024-11-13 19:54:14.728 INFO: Epoch 412: loss=1.6678
2024-11-13 19:54:32.577 INFO: Epoch 414: loss=1.6738
2024-11-13 19:54:50.419 INFO: Epoch 416: loss=1.6742
2024-11-13 19:55:08.270 INFO: Epoch 418: loss=1.6699
2024-11-13 19:55:26.245 INFO: Epoch 420: loss=1.6772
2024-11-13 19:55:44.143 INFO: Epoch 422: loss=1.6739
2024-11-13 19:56:01.986 INFO: Epoch 424: loss=1.6769
2024-11-13 19:56:19.842 INFO: Epoch 426: loss=1.6771
2024-11-13 19:56:37.999 INFO: Epoch 428: loss=1.6815
2024-11-13 19:56:55.908 INFO: Epoch 430: loss=1.6837
2024-11-13 19:57:13.784 INFO: Epoch 432: loss=1.6818
2024-11-13 19:57:31.634 INFO: Epoch 434: loss=1.6818
2024-11-13 19:57:49.495 INFO: Epoch 436: loss=1.6839
2024-11-13 19:58:07.344 INFO: Epoch 438: loss=1.6838
2024-11-13 19:58:25.199 INFO: Epoch 440: loss=1.6808
2024-11-13 19:58:43.059 INFO: Epoch 442: loss=1.6837
2024-11-13 19:59:00.917 INFO: Epoch 444: loss=1.6916
2024-11-13 19:59:18.784 INFO: Epoch 446: loss=1.6914
2024-11-13 19:59:36.643 INFO: Epoch 448: loss=1.6928
2024-11-13 19:59:54.487 INFO: Epoch 450: loss=1.6939
2024-11-13 20:00:12.640 INFO: Epoch 452: loss=1.6940
2024-11-13 20:00:30.544 INFO: Epoch 454: loss=1.6931
2024-11-13 20:00:48.436 INFO: Epoch 456: loss=1.7033
2024-11-13 20:01:06.410 INFO: Epoch 458: loss=1.7021
2024-11-13 20:01:24.321 INFO: Epoch 460: loss=1.7036
2024-11-13 20:01:42.235 INFO: Epoch 462: loss=1.7064
2024-11-13 20:02:00.135 INFO: Epoch 464: loss=1.7065
2024-11-13 20:02:18.081 INFO: Epoch 466: loss=1.7061
2024-11-13 20:02:35.998 INFO: Epoch 468: loss=1.7048
2024-11-13 20:02:53.917 INFO: Epoch 470: loss=1.7105
2024-11-13 20:03:11.837 INFO: Epoch 472: loss=1.7119
2024-11-13 20:03:29.760 INFO: Epoch 474: loss=1.7086
2024-11-13 20:03:47.669 INFO: Epoch 476: loss=1.7058
2024-11-13 20:04:05.599 INFO: Epoch 478: loss=1.7080
2024-11-13 20:04:23.541 INFO: Epoch 480: loss=1.7124
2024-11-13 20:04:41.488 INFO: Epoch 482: loss=1.7149
2024-11-13 20:04:59.416 INFO: Epoch 484: loss=1.7155
2024-11-13 20:05:17.320 INFO: Epoch 486: loss=1.7191
2024-11-13 20:05:35.220 INFO: Epoch 488: loss=1.7231
2024-11-13 20:05:53.109 INFO: Epoch 490: loss=1.7221
2024-11-13 20:06:11.017 INFO: Epoch 492: loss=1.7186
2024-11-13 20:06:28.925 INFO: Epoch 494: loss=1.7194
2024-11-13 20:06:46.820 INFO: Epoch 496: loss=1.7222
2024-11-13 20:07:04.734 INFO: Epoch 498: loss=1.7245
2024-11-13 20:07:22.636 INFO: Epoch 500: loss=1.7267
2024-11-13 20:07:40.548 INFO: Epoch 502: loss=1.7296
2024-11-13 20:07:58.470 INFO: Epoch 504: loss=1.7295
2024-11-13 20:08:16.712 INFO: Epoch 506: loss=1.7289
2024-11-13 20:08:35.044 INFO: Epoch 508: loss=1.7277
2024-11-13 20:08:52.977 INFO: Epoch 510: loss=1.7302
2024-11-13 20:09:10.899 INFO: Epoch 512: loss=1.7289
2024-11-13 20:09:28.832 INFO: Epoch 514: loss=1.7325
2024-11-13 20:09:46.747 INFO: Epoch 516: loss=1.7309
2024-11-13 20:10:04.650 INFO: Epoch 518: loss=1.7331
2024-11-13 20:10:22.535 INFO: Epoch 520: loss=1.7352
2024-11-13 20:10:40.408 INFO: Epoch 522: loss=1.7352
2024-11-13 20:10:58.295 INFO: Epoch 524: loss=1.7370
2024-11-13 20:11:16.201 INFO: Epoch 526: loss=1.7366
2024-11-13 20:11:34.096 INFO: Epoch 528: loss=1.7382
2024-11-13 20:11:51.996 INFO: Epoch 530: loss=1.7374
2024-11-13 20:12:09.885 INFO: Epoch 532: loss=1.7388
2024-11-13 20:12:27.782 INFO: Epoch 534: loss=1.7436
2024-11-13 20:12:45.696 INFO: Epoch 536: loss=1.7452
2024-11-13 20:13:03.598 INFO: Epoch 538: loss=1.7437
2024-11-13 20:13:21.508 INFO: Epoch 540: loss=1.7452
2024-11-13 20:13:39.392 INFO: Epoch 542: loss=1.7458
2024-11-13 20:13:57.252 INFO: Epoch 544: loss=1.7442
2024-11-13 20:14:15.114 INFO: Epoch 546: loss=1.7458
2024-11-13 20:14:32.987 INFO: Epoch 548: loss=1.7474
2024-11-13 20:14:50.863 INFO: Epoch 550: loss=1.7479
2024-11-13 20:15:08.739 INFO: Epoch 552: loss=1.7493
2024-11-13 20:15:26.597 INFO: Epoch 554: loss=1.7483
2024-11-13 20:15:44.467 INFO: Epoch 556: loss=1.7503
2024-11-13 20:16:02.363 INFO: Epoch 558: loss=1.7520
2024-11-13 20:16:20.256 INFO: Epoch 560: loss=1.7516
2024-11-13 20:16:38.128 INFO: Epoch 562: loss=1.7519
2024-11-13 20:16:56.188 INFO: Epoch 564: loss=1.7527
2024-11-13 20:17:14.066 INFO: Epoch 566: loss=1.7531
2024-11-13 20:17:31.954 INFO: Epoch 568: loss=1.7563
2024-11-13 20:17:49.811 INFO: Epoch 570: loss=1.7556
2024-11-13 20:18:07.677 INFO: Epoch 572: loss=1.7557
2024-11-13 20:18:25.531 INFO: Epoch 574: loss=1.7575
2024-11-13 20:18:43.400 INFO: Epoch 576: loss=1.7589
2024-11-13 20:19:01.263 INFO: Epoch 578: loss=1.7590
2024-11-13 20:19:19.111 INFO: Epoch 580: loss=1.7618
2024-11-13 20:19:36.985 INFO: Epoch 582: loss=1.7606
2024-11-13 20:19:54.862 INFO: Epoch 584: loss=1.7623
2024-11-13 20:20:12.724 INFO: Epoch 586: loss=1.7616
2024-11-13 20:20:30.584 INFO: Epoch 588: loss=1.7619
2024-11-13 20:20:48.421 INFO: Epoch 590: loss=1.7620
2024-11-13 20:21:06.265 INFO: Epoch 592: loss=1.7627
2024-11-13 20:21:24.146 INFO: Epoch 594: loss=1.7637
2024-11-13 20:21:42.051 INFO: Epoch 596: loss=1.7646
2024-11-13 20:21:59.917 INFO: Epoch 598: loss=1.7664
2024-11-13 20:22:17.764 INFO: Epoch 600: loss=1.7671
2024-11-13 20:22:35.628 INFO: Epoch 602: loss=1.7671
2024-11-13 20:22:53.493 INFO: Epoch 604: loss=1.7681
2024-11-13 20:23:11.383 INFO: Epoch 606: loss=1.7673
2024-11-13 20:23:29.256 INFO: Epoch 608: loss=1.7689
2024-11-13 20:23:47.148 INFO: Epoch 610: loss=1.7711
2024-11-13 20:24:05.011 INFO: Epoch 612: loss=1.7711
2024-11-13 20:24:22.856 INFO: Epoch 614: loss=1.7712
2024-11-13 20:24:40.706 INFO: Epoch 616: loss=1.7716
2024-11-13 20:24:58.566 INFO: Epoch 618: loss=1.7704
2024-11-13 20:25:16.407 INFO: Epoch 620: loss=1.7730
2024-11-13 20:25:34.276 INFO: Epoch 622: loss=1.7718
2024-11-13 20:25:52.146 INFO: Epoch 624: loss=1.7734
2024-11-13 20:26:10.010 INFO: Epoch 626: loss=1.7739
2024-11-13 20:26:27.859 INFO: Epoch 628: loss=1.7751
2024-11-13 20:26:45.716 INFO: Epoch 630: loss=1.7747
2024-11-13 20:27:03.565 INFO: Epoch 632: loss=1.7768
2024-11-13 20:27:21.410 INFO: Epoch 634: loss=1.7775
2024-11-13 20:27:39.258 INFO: Epoch 636: loss=1.7769
2024-11-13 20:27:57.111 INFO: Epoch 638: loss=1.7781
2024-11-13 20:28:14.970 INFO: Epoch 640: loss=1.7778
2024-11-13 20:28:32.825 INFO: Epoch 642: loss=1.7784
2024-11-13 20:28:50.678 INFO: Epoch 644: loss=1.7786
2024-11-13 20:29:08.515 INFO: Epoch 646: loss=1.7785
2024-11-13 20:29:26.365 INFO: Epoch 648: loss=1.7794
2024-11-13 20:29:44.232 INFO: Epoch 650: loss=1.7802
2024-11-13 20:30:02.086 INFO: Epoch 652: loss=1.7808
2024-11-13 20:30:19.950 INFO: Epoch 654: loss=1.7820
2024-11-13 20:30:37.814 INFO: Epoch 656: loss=1.7826
2024-11-13 20:30:55.692 INFO: Epoch 658: loss=1.7835
2024-11-13 20:31:13.562 INFO: Epoch 660: loss=1.7833
2024-11-13 20:31:31.422 INFO: Epoch 662: loss=1.7830
2024-11-13 20:31:49.275 INFO: Epoch 664: loss=1.7837
2024-11-13 20:32:07.140 INFO: Epoch 666: loss=1.7856
2024-11-13 20:32:24.993 INFO: Epoch 668: loss=1.7846
2024-11-13 20:32:42.855 INFO: Epoch 670: loss=1.7841
2024-11-13 20:33:00.723 INFO: Epoch 672: loss=1.7866
2024-11-13 20:33:18.576 INFO: Epoch 674: loss=1.7858
2024-11-13 20:33:36.436 INFO: Epoch 676: loss=1.7864
2024-11-13 20:33:54.303 INFO: Epoch 678: loss=1.7860
2024-11-13 20:34:12.152 INFO: Epoch 680: loss=1.7870
2024-11-13 20:34:29.992 INFO: Epoch 682: loss=1.7872
2024-11-13 20:34:47.828 INFO: Epoch 684: loss=1.7881
2024-11-13 20:35:05.668 INFO: Epoch 686: loss=1.7879
2024-11-13 20:35:23.532 INFO: Epoch 688: loss=1.7889
2024-11-13 20:35:41.389 INFO: Epoch 690: loss=1.7894
2024-11-13 20:35:59.227 INFO: Epoch 692: loss=1.7894
2024-11-13 20:36:17.084 INFO: Epoch 694: loss=1.7909
2024-11-13 20:36:34.988 INFO: Epoch 696: loss=1.7907
2024-11-13 20:36:52.852 INFO: Epoch 698: loss=1.7920
2024-11-13 20:37:10.720 INFO: Epoch 700: loss=1.7920
2024-11-13 20:37:28.567 INFO: Epoch 702: loss=1.7922
2024-11-13 20:37:46.428 INFO: Epoch 704: loss=1.7928
2024-11-13 20:38:04.278 INFO: Epoch 706: loss=1.7928
2024-11-13 20:38:22.119 INFO: Epoch 708: loss=1.7923
2024-11-13 20:38:39.950 INFO: Epoch 710: loss=1.7934
2024-11-13 20:38:57.808 INFO: Epoch 712: loss=1.7944
2024-11-13 20:39:15.662 INFO: Epoch 714: loss=1.7937
2024-11-13 20:39:33.498 INFO: Epoch 716: loss=1.7944
2024-11-13 20:39:51.329 INFO: Epoch 718: loss=1.7956
2024-11-13 20:40:09.191 INFO: Epoch 720: loss=1.7959
2024-11-13 20:40:27.062 INFO: Epoch 722: loss=1.7957
2024-11-13 20:40:44.931 INFO: Epoch 724: loss=1.7956
2024-11-13 20:41:02.799 INFO: Epoch 726: loss=1.7957
2024-11-13 20:41:20.644 INFO: Epoch 728: loss=1.7961
2024-11-13 20:41:38.479 INFO: Epoch 730: loss=1.7966
2024-11-13 20:41:56.324 INFO: Epoch 732: loss=1.7970
2024-11-13 20:42:14.172 INFO: Epoch 734: loss=1.7975
2024-11-13 20:42:32.018 INFO: Epoch 736: loss=1.7977
2024-11-13 20:42:49.859 INFO: Epoch 738: loss=1.7988
2024-11-13 20:43:07.711 INFO: Epoch 740: loss=1.7982
2024-11-13 20:43:25.563 INFO: Epoch 742: loss=1.7988
2024-11-13 20:43:43.428 INFO: Epoch 744: loss=1.7993
2024-11-13 20:44:01.277 INFO: Epoch 746: loss=1.7986
2024-11-13 20:44:19.123 INFO: Epoch 748: loss=1.7995
2024-11-13 20:44:36.955 INFO: Epoch 750: loss=1.7998
2024-11-13 20:44:54.815 INFO: Epoch 752: loss=1.8000
2024-11-13 20:45:12.670 INFO: Epoch 754: loss=1.7998
2024-11-13 20:45:30.535 INFO: Epoch 756: loss=1.8002
2024-11-13 20:45:48.408 INFO: Epoch 758: loss=1.8010
2024-11-13 20:46:06.251 INFO: Epoch 760: loss=1.8022
2024-11-13 20:46:24.108 INFO: Epoch 762: loss=1.8025
2024-11-13 20:46:41.943 INFO: Epoch 764: loss=1.8027
2024-11-13 20:46:59.816 INFO: Epoch 766: loss=1.8030
2024-11-13 20:47:17.682 INFO: Epoch 768: loss=1.8035
2024-11-13 20:47:35.515 INFO: Epoch 770: loss=1.8037
2024-11-13 20:47:53.346 INFO: Epoch 772: loss=1.8039
2024-11-13 20:48:11.172 INFO: Epoch 774: loss=1.8040
2024-11-13 20:48:29.004 INFO: Epoch 776: loss=1.8040
2024-11-13 20:48:46.845 INFO: Epoch 778: loss=1.8042
2024-11-13 20:49:04.724 INFO: Epoch 780: loss=1.8044
2024-11-13 20:49:22.623 INFO: Epoch 782: loss=1.8049
2024-11-13 20:49:40.488 INFO: Epoch 784: loss=1.8054
2024-11-13 20:49:58.338 INFO: Epoch 786: loss=1.8060
2024-11-13 20:50:16.192 INFO: Epoch 788: loss=1.8065
2024-11-13 20:50:34.001 INFO: Epoch 790: loss=1.8061
2024-11-13 20:50:51.879 INFO: Epoch 792: loss=1.8067
2024-11-13 20:51:09.762 INFO: Epoch 794: loss=1.8063
2024-11-13 20:51:27.684 INFO: Epoch 796: loss=1.8074
2024-11-13 20:51:45.532 INFO: Epoch 798: loss=1.8078
2024-11-13 20:52:03.389 INFO: Epoch 800: loss=1.8080
2024-11-13 20:52:21.235 INFO: Epoch 802: loss=1.8077
2024-11-13 20:52:39.097 INFO: Epoch 804: loss=1.8083
2024-11-13 20:52:56.927 INFO: Epoch 806: loss=1.8078
2024-11-13 20:53:14.747 INFO: Epoch 808: loss=1.8081
2024-11-13 20:53:32.606 INFO: Epoch 810: loss=1.8092
2024-11-13 20:53:50.443 INFO: Epoch 812: loss=1.8086
2024-11-13 20:54:08.303 INFO: Epoch 814: loss=1.8092
2024-11-13 20:54:26.155 INFO: Epoch 816: loss=1.8091
2024-11-13 20:54:43.995 INFO: Epoch 818: loss=1.8095
2024-11-13 20:55:01.841 INFO: Epoch 820: loss=1.8094
2024-11-13 20:55:19.680 INFO: Epoch 822: loss=1.8097
2024-11-13 20:55:37.540 INFO: Epoch 824: loss=1.8101
2024-11-13 20:55:55.398 INFO: Epoch 826: loss=1.8101
2024-11-13 20:56:13.262 INFO: Epoch 828: loss=1.8103
2024-11-13 20:56:31.135 INFO: Epoch 830: loss=1.8106
2024-11-13 20:56:48.996 INFO: Epoch 832: loss=1.8109
2024-11-13 20:57:06.843 INFO: Epoch 834: loss=1.8111
2024-11-13 20:57:24.692 INFO: Epoch 836: loss=1.8118
2024-11-13 20:57:42.563 INFO: Epoch 838: loss=1.8116
2024-11-13 20:58:00.447 INFO: Epoch 840: loss=1.8119
2024-11-13 20:58:18.316 INFO: Epoch 842: loss=1.8107
2024-11-13 20:58:36.185 INFO: Epoch 844: loss=1.8116
2024-11-13 20:58:54.220 INFO: Epoch 846: loss=1.8118
2024-11-13 20:59:12.168 INFO: Epoch 848: loss=1.8121
2024-11-13 20:59:30.096 INFO: Epoch 850: loss=1.8128
2024-11-13 20:59:30.097 INFO: Stopping optimization after 256 epochs without improvement
2024-11-13 20:59:30.097 INFO: Training complete
2024-11-13 20:59:30.099 INFO: Loading checkpoint: checkpoints/gaunt-3bpa_run-6_epoch-444.pt
2024-11-13 20:59:30.153 INFO: Loaded model from epoch 444
2024-11-13 20:59:30.154 INFO: Computing metrics for training, validation, and test sets
2024-11-13 20:59:33.880 INFO: Subset 'train': loss=721.2352, mae_e=17734.001 meV, mae_f=640.052 meV/Ang, rmse_e=17740.631 meV, rmse_f=842.365 meV/Ang, q95_e=18537.305 meV, q95_f=1738.173 meV/Ang
2024-11-13 20:59:34.307 INFO: Subset 'valid': loss=783.2669, mae_e=17614.765 meV, mae_f=663.388 meV/Ang, rmse_e=17621.338 meV, rmse_f=878.502 meV/Ang, q95_e=18458.984 meV, q95_f=1762.025 meV/Ang
2024-11-13 20:59:48.290 INFO: Subset 'test_300K': loss=735.0859, mae_e=17682.030 meV, mae_f=645.686 meV/Ang, rmse_e=17688.866 meV, rmse_f=850.535 meV/Ang, q95_e=18516.797 meV, q95_f=1746.781 meV/Ang
2024-11-13 21:00:06.538 INFO: Subset 'test_600K': loss=1360.5980, mae_e=16854.607 meV, mae_f=881.324 meV/Ang, rmse_e=16861.668 meV, rmse_f=1161.885 meV/Ang, q95_e=17627.246 meV, q95_f=2387.934 meV/Ang
2024-11-13 21:00:24.759 INFO: Subset 'test_1200K': loss=2555.0680, mae_e=15043.425 meV, mae_f=1207.591 meV/Ang, rmse_e=15059.914 meV, rmse_f=1595.857 meV/Ang, q95_e=16158.203 meV, q95_f=3273.287 meV/Ang
2024-11-13 21:01:23.644 INFO: Subset 'test_dih': loss=192.5230, mae_e=18321.239 meV, mae_f=293.985 meV/Ang, rmse_e=18323.298 meV, rmse_f=424.377 meV/Ang, q95_e=18724.609 meV, q95_f=927.458 meV/Ang
2024-11-13 21:01:23.649 INFO: Saving model to checkpoints/gaunt-3bpa_run-6.model
2024-11-13 21:01:23.700 INFO: Done
2024-11-14 06:50:44.217 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 06:50:44.435 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 06:50:44.436 INFO: Loading 3BPA dataset
2024-11-14 06:50:48.212 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 06:50:48.214 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 06:50:49.103 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 06:50:49.159 INFO: Average number of neighbors: 16.712
2024-11-14 06:50:49.159 INFO: Building model
2024-11-14 06:50:50.502 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=10x5 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=10x5 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x1 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x1 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 06:50:50.504 INFO: Number of parameters: 2803984
2024-11-14 06:50:50.504 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 06:50:50.504 INFO: Started training
2024-11-14 07:53:36.513 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 07:53:36.732 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 07:53:36.732 INFO: Loading 3BPA dataset
2024-11-14 07:53:40.545 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 07:53:40.547 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 07:53:41.439 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 07:53:41.497 INFO: Average number of neighbors: 16.712
2024-11-14 07:53:41.497 INFO: Building model
2024-11-14 07:53:42.857 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=10x5 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=10x5 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x1 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x1 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 07:53:42.859 INFO: Number of parameters: 2803984
2024-11-14 07:53:42.859 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 07:53:42.859 INFO: Started training
2024-11-14 08:01:22.317 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 08:01:22.534 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 08:01:22.534 INFO: Loading 3BPA dataset
2024-11-14 08:01:26.350 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 08:01:26.352 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 08:01:26.963 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 08:01:27.002 INFO: Average number of neighbors: 16.712
2024-11-14 08:01:27.002 INFO: Building model
2024-11-14 08:01:28.347 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=10x5 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=10x5 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x1 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x1 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 08:01:28.348 INFO: Number of parameters: 2803984
2024-11-14 08:01:28.348 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 08:01:28.349 INFO: Started training
2024-11-14 08:01:29.790 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): GauntTensorProductS2Grid(
    (to_s2grid): ToS2Grid(lmax=2 res=10x5 (beta x alpha))
    (from_s2grid): FromS2Grid(lmax=2 res=10x5 (beta x alpha))
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=2.323e-01 in argument 0
(parity_k=1, did_translate=False) -> max error=2.170e-01 in argument 0
2024-11-14 08:01:50.264 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 08:01:50.480 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 08:01:50.480 INFO: Loading 3BPA dataset
2024-11-14 08:01:54.450 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 08:01:54.453 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 08:01:55.040 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 08:01:55.080 INFO: Average number of neighbors: 16.712
2024-11-14 08:01:55.080 INFO: Building model
2024-11-14 08:01:56.427 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=10x5 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=10x5 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x1 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x1 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 08:01:56.429 INFO: Number of parameters: 2803984
2024-11-14 08:01:56.429 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 08:01:56.429 INFO: Started training
2024-11-14 08:01:57.875 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): GauntTensorProductS2Grid(
    (to_s2grid): ToS2Grid(lmax=2 res=10x5 (beta x alpha))
    (from_s2grid): FromS2Grid(lmax=2 res=10x5 (beta x alpha))
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.871e-01 in argument 0
(parity_k=1, did_translate=False) -> max error=2.083e-01 in argument 0
2024-11-14 08:04:11.526 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 08:04:11.742 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 08:04:11.742 INFO: Loading 3BPA dataset
2024-11-14 08:04:15.808 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 08:04:15.811 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 08:04:16.412 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 08:04:16.451 INFO: Average number of neighbors: 16.712
2024-11-14 08:04:16.451 INFO: Building model
2024-11-14 08:04:17.719 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 08:04:17.721 INFO: Number of parameters: 2803984
2024-11-14 08:04:17.721 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 08:04:17.721 INFO: Started training
2024-11-14 08:05:05.307 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 08:05:05.518 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 08:05:05.518 INFO: Loading 3BPA dataset
2024-11-14 08:05:09.577 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 08:05:09.579 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 08:05:10.334 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 08:05:10.396 INFO: Average number of neighbors: 16.712
2024-11-14 08:05:10.396 INFO: Building model
2024-11-14 08:05:11.650 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProduct(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 08:05:11.652 INFO: Number of parameters: 2803984
2024-11-14 08:05:11.652 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 08:05:11.652 INFO: Started training
2024-11-14 08:05:13.191 INFO: Tested equivariance of `<bound method EfficientMultiTensorProduct.forward of EfficientMultiTensorProduct(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.596e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=1.628e-08 in argument 0
2024-11-14 08:05:13.384 INFO: Tested equivariance of `<bound method EfficientMultiTensorProduct.forward of EfficientMultiTensorProduct(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.863e-09 in argument 0
(parity_k=1, did_translate=False) -> max error=1.863e-09 in argument 0
2024-11-14 08:05:44.336 INFO: Epoch 0: loss=44.7029
2024-11-14 08:06:28.992 INFO: Epoch 2: loss=8.3121
2024-11-14 08:07:13.417 INFO: Epoch 4: loss=4.9068
2024-11-14 08:07:57.767 INFO: Epoch 6: loss=3.6135
2024-11-14 08:08:42.099 INFO: Epoch 8: loss=2.7961
2024-11-14 08:09:26.459 INFO: Epoch 10: loss=2.2741
2024-11-14 08:10:10.871 INFO: Epoch 12: loss=1.8950
2024-11-14 08:10:55.273 INFO: Epoch 14: loss=1.6281
2024-11-14 08:11:39.586 INFO: Epoch 16: loss=1.4236
2024-11-14 08:12:23.936 INFO: Epoch 18: loss=1.2473
2024-11-14 08:13:08.303 INFO: Epoch 20: loss=1.1501
2024-11-14 08:13:52.655 INFO: Epoch 22: loss=1.0334
2024-11-14 08:14:36.996 INFO: Epoch 24: loss=0.9496
2024-11-14 08:14:54.816 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 08:14:55.026 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 08:14:55.026 INFO: Loading 3BPA dataset
2024-11-14 08:14:58.880 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 08:14:58.882 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 08:14:59.778 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 08:14:59.836 INFO: Average number of neighbors: 16.712
2024-11-14 08:14:59.836 INFO: Building model
2024-11-14 08:15:01.191 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=10x5 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=10x5 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x1 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x1 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 08:15:01.192 INFO: Number of parameters: 2803984
2024-11-14 08:15:01.192 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 08:15:01.193 INFO: Started training
2024-11-14 08:15:02.659 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): GauntTensorProductS2Grid(
    (to_s2grid): ToS2Grid(lmax=2 res=10x5 (beta x alpha))
    (from_s2grid): FromS2Grid(lmax=2 res=10x5 (beta x alpha))
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.871e-01 in argument 0
(parity_k=1, did_translate=False) -> max error=2.083e-01 in argument 0
2024-11-14 08:18:05.970 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 08:18:06.187 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 08:18:06.187 INFO: Loading 3BPA dataset
2024-11-14 08:18:10.090 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 08:18:10.092 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 08:18:10.977 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 08:18:11.033 INFO: Average number of neighbors: 16.712
2024-11-14 08:18:11.033 INFO: Building model
2024-11-14 08:18:12.376 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=10x5 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=10x5 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x1 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x1 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 08:18:12.377 INFO: Number of parameters: 2803984
2024-11-14 08:18:12.377 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 08:18:12.378 INFO: Started training
2024-11-14 08:18:13.825 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): GauntTensorProductS2Grid(
    (to_s2grid): ToS2Grid(lmax=2 res=10x5 (beta x alpha))
    (from_s2grid): FromS2Grid(lmax=2 res=10x5 (beta x alpha))
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=2.986e-03 in argument 0
(parity_k=1, did_translate=False) -> max error=3.773e-03 in argument 0
2024-11-14 08:19:36.746 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 08:19:36.960 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 08:19:36.960 INFO: Loading 3BPA dataset
2024-11-14 08:19:41.029 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 08:19:41.031 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 08:19:41.924 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 08:19:41.985 INFO: Average number of neighbors: 16.712
2024-11-14 08:19:41.985 INFO: Building model
2024-11-14 08:19:43.371 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=2 res=18x9 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=2 res=18x9 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x1 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x1 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 08:19:43.373 INFO: Number of parameters: 2803984
2024-11-14 08:19:43.373 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 08:19:43.373 INFO: Started training
2024-11-14 08:19:44.856 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): GauntTensorProductS2Grid(
    (to_s2grid): ToS2Grid(lmax=2 res=18x9 (beta x alpha))
    (from_s2grid): FromS2Grid(lmax=2 res=18x9 (beta x alpha))
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=2.124e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=1.537e-08 in argument 0
2024-11-14 08:19:45.021 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): GauntTensorProductS2Grid(
    (to_s2grid): ToS2Grid(lmax=0 res=2x1 (beta x alpha))
    (from_s2grid): FromS2Grid(lmax=0 res=2x1 (beta x alpha))
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=0.000e+00 in argument 0
(parity_k=1, did_translate=False) -> max error=0.000e+00 in argument 0
2024-11-14 08:20:04.026 INFO: Epoch 0: loss=72.6562
2024-11-14 08:20:25.562 INFO: Epoch 2: loss=20.4566
2024-11-14 08:20:47.191 INFO: Epoch 4: loss=14.0356
2024-11-14 08:21:09.070 INFO: Epoch 6: loss=10.8997
2024-11-14 08:21:30.801 INFO: Epoch 8: loss=9.0758
2024-11-14 08:21:52.567 INFO: Epoch 10: loss=7.5131
2024-11-14 08:22:14.349 INFO: Epoch 12: loss=6.4049
2024-11-14 08:22:36.114 INFO: Epoch 14: loss=5.6423
2024-11-14 08:22:57.886 INFO: Epoch 16: loss=5.1165
2024-11-14 08:23:19.818 INFO: Epoch 18: loss=4.7492
2024-11-14 08:23:41.643 INFO: Epoch 20: loss=4.3658
2024-11-14 08:24:03.469 INFO: Epoch 22: loss=4.0570
2024-11-14 08:24:25.291 INFO: Epoch 24: loss=3.8232
2024-11-14 08:24:47.166 INFO: Epoch 26: loss=3.6255
2024-11-14 08:25:08.994 INFO: Epoch 28: loss=3.4213
2024-11-14 08:25:30.807 INFO: Epoch 30: loss=3.2350
2024-11-14 08:25:52.630 INFO: Epoch 32: loss=3.0994
2024-11-14 08:26:14.459 INFO: Epoch 34: loss=2.9601
2024-11-14 08:26:36.262 INFO: Epoch 36: loss=2.8453
2024-11-14 08:26:58.070 INFO: Epoch 38: loss=2.7278
2024-11-14 08:27:19.894 INFO: Epoch 40: loss=2.5987
2024-11-14 08:27:41.707 INFO: Epoch 42: loss=2.5019
2024-11-14 08:28:03.504 INFO: Epoch 44: loss=2.4200
2024-11-14 08:28:25.297 INFO: Epoch 46: loss=2.3426
2024-11-14 08:28:47.095 INFO: Epoch 48: loss=2.2440
2024-11-14 08:29:08.890 INFO: Epoch 50: loss=2.1740
2024-11-14 08:29:30.677 INFO: Epoch 52: loss=2.1082
2024-11-14 08:29:52.471 INFO: Epoch 54: loss=2.0422
2024-11-14 08:30:14.259 INFO: Epoch 56: loss=1.9896
2024-11-14 08:30:36.058 INFO: Epoch 58: loss=1.9227
2024-11-14 08:30:57.845 INFO: Epoch 60: loss=1.8830
2024-11-14 08:31:19.637 INFO: Epoch 62: loss=1.8276
2024-11-14 08:31:41.427 INFO: Epoch 64: loss=1.7808
2024-11-14 08:32:03.237 INFO: Epoch 66: loss=1.7469
2024-11-14 08:32:25.022 INFO: Epoch 68: loss=1.7062
2024-11-14 08:32:46.826 INFO: Epoch 70: loss=1.6796
2024-11-14 08:33:08.643 INFO: Epoch 72: loss=1.6316
2024-11-14 08:33:30.446 INFO: Epoch 74: loss=1.5888
2024-11-14 08:33:52.247 INFO: Epoch 76: loss=1.5637
2024-11-14 08:41:20.790 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 08:41:21.010 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 08:41:21.010 INFO: Loading 3BPA dataset
2024-11-14 08:41:24.938 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 08:41:24.940 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 08:41:25.830 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 08:41:25.888 INFO: Average number of neighbors: 16.712
2024-11-14 08:41:25.888 INFO: Building model
2024-11-14 08:41:27.422 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=4 res=18x9 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=4 res=18x9 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): GauntTensorProductS2Grid(
          (to_s2grid): ToS2Grid(lmax=0 res=2x1 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=0 res=2x1 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 08:41:27.423 INFO: Number of parameters: 2803984
2024-11-14 08:41:27.424 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 08:41:27.424 INFO: Started training
2024-11-14 09:00:56.432 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 09:00:56.646 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 09:00:56.646 INFO: Loading 3BPA dataset
2024-11-14 09:01:00.399 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 09:01:00.401 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 09:01:01.284 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 09:01:01.340 INFO: Average number of neighbors: 16.712
2024-11-14 09:01:01.340 INFO: Building model
2024-11-14 09:01:03.693 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=4 res=34x17 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=4 res=34x17 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=6 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=8 res=66x33 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=8 res=66x33 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=0 res=2x1 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=0 res=2x1 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=0 res=2x1 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=0 res=2x1 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=0 res=2x1 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=0 res=2x1 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 09:01:03.695 INFO: Number of parameters: 2803984
2024-11-14 09:01:03.695 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 09:01:03.695 INFO: Started training
2024-11-14 09:02:07.696 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 09:02:07.904 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 09:02:07.905 INFO: Loading 3BPA dataset
2024-11-14 09:02:11.932 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 09:02:11.934 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 09:02:12.526 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 09:02:12.567 INFO: Average number of neighbors: 16.712
2024-11-14 09:02:12.567 INFO: Building model
2024-11-14 09:02:17.203 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=6 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=9 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=6 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=9 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 09:02:17.205 INFO: Number of parameters: 2803984
2024-11-14 09:02:17.205 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 09:02:17.205 INFO: Started training
2024-11-14 09:03:09.220 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 09:03:09.433 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 09:03:09.434 INFO: Loading 3BPA dataset
2024-11-14 09:03:13.229 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 09:03:13.231 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 09:03:13.806 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 09:03:13.845 INFO: Average number of neighbors: 16.712
2024-11-14 09:03:13.845 INFO: Building model
2024-11-14 09:03:18.513 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=6 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=9 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=6 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=9 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 09:03:18.515 INFO: Number of parameters: 2803984
2024-11-14 09:03:18.515 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 09:03:18.515 INFO: Started training
2024-11-14 09:04:14.880 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 09:04:15.088 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 09:04:15.088 INFO: Loading 3BPA dataset
2024-11-14 09:04:18.903 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 09:04:18.905 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 09:04:19.789 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 09:04:19.844 INFO: Average number of neighbors: 16.712
2024-11-14 09:04:19.845 INFO: Building model
2024-11-14 09:04:24.474 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=6 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=9 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=6 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=9 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 09:04:24.476 INFO: Number of parameters: 2803984
2024-11-14 09:04:24.476 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 09:04:24.476 INFO: Started training
2024-11-14 09:05:10.173 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 09:05:10.383 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 09:05:10.383 INFO: Loading 3BPA dataset
2024-11-14 09:05:14.161 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 09:05:14.163 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 09:05:15.054 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 09:05:15.110 INFO: Average number of neighbors: 16.712
2024-11-14 09:05:15.111 INFO: Building model
2024-11-14 09:05:19.749 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=6 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=9 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=6 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=9 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 09:05:19.751 INFO: Number of parameters: 2803984
2024-11-14 09:05:19.751 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 09:05:19.751 INFO: Started training
2024-11-14 09:14:23.956 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 09:14:24.184 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 09:14:24.185 INFO: Loading 3BPA dataset
2024-11-14 09:14:28.050 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 09:14:28.052 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 09:14:28.855 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 09:14:28.911 INFO: Average number of neighbors: 16.712
2024-11-14 09:14:28.911 INFO: Building model
2024-11-14 09:14:33.012 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=9 res=98x49 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=98x49 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=9 res=98x49 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=98x49 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 09:14:33.013 INFO: Number of parameters: 2803984
2024-11-14 09:14:33.013 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 09:14:33.013 INFO: Started training
2024-11-14 09:14:42.174 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 09:14:42.396 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 09:14:42.396 INFO: Loading 3BPA dataset
2024-11-14 09:14:46.206 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 09:14:46.208 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 09:14:47.097 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 09:14:47.153 INFO: Average number of neighbors: 16.712
2024-11-14 09:14:47.153 INFO: Building model
2024-11-14 09:14:51.261 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=9 res=98x49 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=98x49 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=9 res=98x49 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=98x49 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 09:14:51.263 INFO: Number of parameters: 2803984
2024-11-14 09:14:51.263 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 09:14:51.263 INFO: Started training
2024-11-14 09:14:52.934 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
    )
    (3): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=9 res=98x49 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=98x49 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.692e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=1.656e-08 in argument 0
2024-11-14 09:14:53.337 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
    )
    (3): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=9 res=98x49 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=98x49 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.863e-09 in argument 0
(parity_k=1, did_translate=False) -> max error=1.863e-09 in argument 0
2024-11-14 09:15:33.846 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 09:15:34.077 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 09:15:34.078 INFO: Loading 3BPA dataset
2024-11-14 09:15:38.210 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 09:15:38.212 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 09:15:39.110 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 09:15:39.169 INFO: Average number of neighbors: 16.712
2024-11-14 09:15:39.169 INFO: Building model
2024-11-14 09:15:43.348 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=9 res=98x49 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=98x49 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
          (3): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=9 res=98x49 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=98x49 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 09:15:43.349 INFO: Number of parameters: 2803984
2024-11-14 09:15:43.349 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 09:15:43.349 INFO: Started training
2024-11-14 09:15:45.007 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
    )
    (3): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=9 res=98x49 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=98x49 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.683e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=1.597e-08 in argument 0
2024-11-14 09:15:45.410 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
    )
    (3): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=9 res=98x49 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=98x49 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=9.313e-10 in argument 0
(parity_k=1, did_translate=False) -> max error=9.313e-10 in argument 0
2024-11-14 09:17:09.117 INFO: Epoch 0: loss=52.7351
2024-11-14 09:19:39.131 INFO: Epoch 2: loss=8.8306
2024-11-14 09:22:09.186 INFO: Epoch 4: loss=5.1419
2024-11-14 09:24:39.233 INFO: Epoch 6: loss=3.6913
2024-11-14 09:27:09.275 INFO: Epoch 8: loss=2.8342
2024-11-14 09:29:39.315 INFO: Epoch 10: loss=2.3002
2024-11-14 09:32:09.361 INFO: Epoch 12: loss=1.9075
2024-11-14 09:34:39.392 INFO: Epoch 14: loss=1.6325
2024-11-14 09:37:09.399 INFO: Epoch 16: loss=1.4281
2024-11-14 09:39:39.412 INFO: Epoch 18: loss=1.2498
2024-11-14 09:42:09.473 INFO: Epoch 20: loss=1.1401
2024-11-14 09:44:39.470 INFO: Epoch 22: loss=1.0326
2024-11-14 09:47:09.479 INFO: Epoch 24: loss=0.9518
2024-11-14 09:49:39.481 INFO: Epoch 26: loss=0.8761
2024-11-14 09:52:09.496 INFO: Epoch 28: loss=0.8060
2024-11-14 09:54:39.513 INFO: Epoch 30: loss=0.7489
2024-11-14 09:57:09.536 INFO: Epoch 32: loss=0.7013
2024-11-14 09:59:39.548 INFO: Epoch 34: loss=0.6740
2024-11-14 10:02:09.551 INFO: Epoch 36: loss=0.6359
2024-11-14 10:04:39.549 INFO: Epoch 38: loss=0.6036
2024-11-14 10:07:09.552 INFO: Epoch 40: loss=0.5677
2024-11-14 10:09:39.566 INFO: Epoch 42: loss=0.5428
2024-11-14 10:12:09.570 INFO: Epoch 44: loss=0.5252
2024-11-14 10:14:39.583 INFO: Epoch 46: loss=0.4944
2024-11-14 10:17:09.678 INFO: Epoch 48: loss=0.4749
2024-11-14 10:19:39.873 INFO: Epoch 50: loss=0.4543
2024-11-14 10:22:09.887 INFO: Epoch 52: loss=0.4392
2024-11-14 10:24:39.941 INFO: Epoch 54: loss=0.4297
2024-11-14 10:27:09.996 INFO: Epoch 56: loss=0.4173
2024-11-14 10:29:40.064 INFO: Epoch 58: loss=0.4028
2024-11-14 10:32:10.127 INFO: Epoch 60: loss=0.3975
2024-11-14 10:34:40.202 INFO: Epoch 62: loss=0.3817
2024-11-14 10:37:10.267 INFO: Epoch 64: loss=0.3678
2024-11-14 10:39:40.318 INFO: Epoch 66: loss=0.3606
2024-11-14 10:42:10.376 INFO: Epoch 68: loss=0.3487
2024-11-14 10:44:40.438 INFO: Epoch 70: loss=0.3419
2024-11-14 10:47:10.508 INFO: Epoch 72: loss=0.3325
2024-11-14 10:49:40.581 INFO: Epoch 74: loss=0.3254
2024-11-14 10:52:10.647 INFO: Epoch 76: loss=0.3194
2024-11-14 10:54:40.797 INFO: Epoch 78: loss=0.3121
2024-11-14 10:57:10.880 INFO: Epoch 80: loss=0.3034
2024-11-14 10:59:40.969 INFO: Epoch 82: loss=0.2962
2024-11-14 11:02:11.062 INFO: Epoch 84: loss=0.2973
2024-11-14 11:04:41.084 INFO: Epoch 86: loss=0.2909
2024-11-14 11:17:04.104 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 11:17:04.315 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 11:17:04.315 INFO: Loading 3BPA dataset
2024-11-14 11:17:08.132 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 11:17:08.134 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 11:17:08.724 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 11:17:08.765 INFO: Average number of neighbors: 16.712
2024-11-14 11:17:08.765 INFO: Building model
2024-11-14 11:17:11.877 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
        )
        (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
          (to_s2grid): ToS2Grid(lmax=9 res=74x37 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
        )
        (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
          (to_s2grid): ToS2Grid(lmax=9 res=74x37 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 11:17:11.879 INFO: Number of parameters: 2803984
2024-11-14 11:17:11.879 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 11:17:11.879 INFO: Started training
2024-11-14 11:18:23.214 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 11:18:23.431 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 11:18:23.432 INFO: Loading 3BPA dataset
2024-11-14 11:18:27.242 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 11:18:27.244 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 11:18:28.130 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 11:18:28.185 INFO: Average number of neighbors: 16.712
2024-11-14 11:18:28.186 INFO: Building model
2024-11-14 11:18:31.289 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
        )
        (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
          (to_s2grid): ToS2Grid(lmax=9 res=74x37 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
        )
        (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
          (to_s2grid): ToS2Grid(lmax=9 res=74x37 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 11:18:31.291 INFO: Number of parameters: 2803984
2024-11-14 11:18:31.291 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 11:18:31.291 INFO: Started training
2024-11-14 11:20:40.964 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 11:20:41.180 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 11:20:41.180 INFO: Loading 3BPA dataset
2024-11-14 11:20:44.974 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 11:20:44.976 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 11:20:45.864 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 11:20:45.920 INFO: Average number of neighbors: 16.712
2024-11-14 11:20:45.920 INFO: Building model
2024-11-14 11:20:49.049 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
        )
        (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
          (to_s2grid): ToS2Grid(lmax=9 res=74x37 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
        )
        (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
          (to_s2grid): ToS2Grid(lmax=9 res=74x37 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 11:20:49.051 INFO: Number of parameters: 2803984
2024-11-14 11:20:49.051 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 11:20:49.052 INFO: Started training
2024-11-14 11:21:37.896 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 11:21:38.108 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 11:21:38.108 INFO: Loading 3BPA dataset
2024-11-14 11:21:41.896 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 11:21:41.898 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 11:21:42.721 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 11:21:42.760 INFO: Average number of neighbors: 16.712
2024-11-14 11:21:42.760 INFO: Building model
2024-11-14 11:21:47.250 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
        )
        (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
          (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
        )
        (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
          (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 11:21:47.252 INFO: Number of parameters: 2803984
2024-11-14 11:21:47.252 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 11:21:47.252 INFO: Started training
2024-11-14 11:21:49.195 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
    )
  )
  (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
    (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
    (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.599e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=1.813e-08 in argument 0
2024-11-14 11:21:49.950 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
    )
  )
  (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
    (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
    (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=9.313e-10 in argument 0
(parity_k=1, did_translate=False) -> max error=9.313e-10 in argument 0
2024-11-14 11:25:12.690 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 11:25:12.908 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 11:25:12.909 INFO: Loading 3BPA dataset
2024-11-14 11:25:16.713 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 11:25:16.715 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 11:25:17.553 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 11:25:17.592 INFO: Average number of neighbors: 16.712
2024-11-14 11:25:17.592 INFO: Building model
2024-11-14 11:25:21.322 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
          (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
          (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 11:25:21.324 INFO: Number of parameters: 2803984
2024-11-14 11:25:21.324 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 11:25:21.324 INFO: Started training
2024-11-14 11:25:35.464 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 11:25:35.674 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 11:25:35.675 INFO: Loading 3BPA dataset
2024-11-14 11:25:39.473 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 11:25:39.476 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 11:25:40.365 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 11:25:40.421 INFO: Average number of neighbors: 16.712
2024-11-14 11:25:40.421 INFO: Building model
2024-11-14 11:25:44.131 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
          (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
          (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
          (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 11:25:44.132 INFO: Number of parameters: 2803984
2024-11-14 11:25:44.133 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 11:25:44.133 INFO: Started training
2024-11-14 11:25:46.073 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
    (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
    (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.599e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=1.891e-08 in argument 0
2024-11-14 11:25:46.826 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid_opt): GauntTensorProductS2GridOptimized(
    (to_s2grid): ToS2Grid(lmax=12 res=98x49 (beta x alpha))
    (from_s2grid): FromS2Grid(lmax=12 res=98x49 (beta x alpha))
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=9.313e-10 in argument 0
(parity_k=1, did_translate=False) -> max error=1.863e-09 in argument 0
2024-11-14 11:37:44.749 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 11:37:44.967 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 11:37:44.967 INFO: Loading 3BPA dataset
2024-11-14 11:37:48.763 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 11:37:48.765 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 11:37:49.653 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 11:37:49.709 INFO: Average number of neighbors: 16.712
2024-11-14 11:37:49.709 INFO: Building model
2024-11-14 11:37:52.346 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 11:37:52.348 INFO: Number of parameters: 2803984
2024-11-14 11:37:52.348 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 11:37:52.348 INFO: Started training
2024-11-14 11:38:23.663 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 11:38:23.875 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 11:38:23.875 INFO: Loading 3BPA dataset
2024-11-14 11:38:27.922 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 11:38:27.924 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 11:38:28.529 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 11:38:28.569 INFO: Average number of neighbors: 16.712
2024-11-14 11:38:28.569 INFO: Building model
2024-11-14 11:38:31.237 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 11:38:31.239 INFO: Number of parameters: 2803984
2024-11-14 11:38:31.239 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 11:38:31.239 INFO: Started training
2024-11-14 11:38:32.882 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.683e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=1.555e-08 in argument 0
2024-11-14 11:38:33.283 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=50x25 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=50x25 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=74x37 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=74x37 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=74x37 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.863e-09 in argument 0
(parity_k=1, did_translate=False) -> max error=9.313e-10 in argument 0
2024-11-14 11:39:56.850 INFO: Epoch 0: loss=52.7351
2024-11-14 11:42:26.975 INFO: Epoch 2: loss=8.8306
2024-11-14 12:38:42.436 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 12:38:42.649 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 12:38:42.650 INFO: Loading 3BPA dataset
2024-11-14 12:38:46.797 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 12:38:46.799 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 12:38:47.682 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 12:38:47.738 INFO: Average number of neighbors: 16.712
2024-11-14 12:38:47.738 INFO: Building model
2024-11-14 12:38:50.455 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 12:38:50.457 INFO: Number of parameters: 2803984
2024-11-14 12:38:50.458 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 12:38:50.458 INFO: Started training
2024-11-14 12:38:52.006 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.683e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=1.597e-08 in argument 0
2024-11-14 12:38:52.235 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.863e-09 in argument 0
(parity_k=1, did_translate=False) -> max error=1.863e-09 in argument 0
2024-11-14 12:39:27.782 INFO: Epoch 0: loss=52.7351
2024-11-14 12:40:22.626 INFO: Epoch 2: loss=8.8306
2024-11-14 12:40:33.312 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 12:40:33.531 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 12:40:33.532 INFO: Loading 3BPA dataset
2024-11-14 12:40:37.563 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 12:40:37.564 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 12:40:38.152 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 12:40:38.194 INFO: Average number of neighbors: 16.712
2024-11-14 12:40:38.194 INFO: Building model
2024-11-14 12:40:40.907 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 12:40:40.909 INFO: Number of parameters: 2803984
2024-11-14 12:40:40.909 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 12:40:40.909 INFO: Started training
2024-11-14 12:40:42.362 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=0.000e+00 in argument 0
(parity_k=1, did_translate=False) -> max error=0.000e+00 in argument 0
2024-11-14 12:40:42.516 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=0.000e+00 in argument 0
(parity_k=1, did_translate=False) -> max error=0.000e+00 in argument 0
2024-11-14 12:41:30.528 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 12:41:30.739 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 12:41:30.739 INFO: Loading 3BPA dataset
2024-11-14 12:41:34.787 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 12:41:34.789 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 12:41:35.675 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 12:41:35.731 INFO: Average number of neighbors: 16.712
2024-11-14 12:41:35.731 INFO: Building model
2024-11-14 12:41:38.356 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 12:41:38.358 INFO: Number of parameters: 2803984
2024-11-14 12:41:38.358 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 12:41:38.358 INFO: Started training
2024-11-14 12:41:39.873 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.294e+01 in argument 0
(parity_k=1, did_translate=False) -> max error=1.505e+01 in argument 0
2024-11-14 12:42:02.071 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 12:42:02.302 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 12:42:02.302 INFO: Loading 3BPA dataset
2024-11-14 12:42:06.311 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 12:42:06.313 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 12:42:06.892 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 12:42:06.933 INFO: Average number of neighbors: 16.712
2024-11-14 12:42:06.933 INFO: Building model
2024-11-14 12:42:09.553 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 12:42:09.555 INFO: Number of parameters: 2803984
2024-11-14 12:42:09.555 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 12:42:09.555 INFO: Started training
2024-11-14 12:42:11.036 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=0.000e+00 in argument 0
(parity_k=1, did_translate=False) -> max error=0.000e+00 in argument 0
2024-11-14 12:42:11.263 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=0.000e+00 in argument 0
(parity_k=1, did_translate=False) -> max error=0.000e+00 in argument 0
2024-11-14 12:44:51.305 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 12:44:51.526 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 12:44:51.526 INFO: Loading 3BPA dataset
2024-11-14 12:44:55.517 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 12:44:55.519 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 12:44:56.407 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 12:44:56.462 INFO: Average number of neighbors: 16.712
2024-11-14 12:44:56.462 INFO: Building model
2024-11-14 12:44:59.119 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 12:44:59.121 INFO: Number of parameters: 2803984
2024-11-14 12:44:59.121 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 12:44:59.121 INFO: Started training
2024-11-14 12:45:00.579 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=0.000e+00 in argument 0
(parity_k=1, did_translate=False) -> max error=0.000e+00 in argument 0
2024-11-14 12:45:00.740 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=0.000e+00 in argument 0
(parity_k=1, did_translate=False) -> max error=0.000e+00 in argument 0
2024-11-14 12:53:10.533 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 12:53:10.755 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 12:53:10.755 INFO: Loading 3BPA dataset
2024-11-14 12:53:14.746 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 12:53:14.748 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 12:53:15.331 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 12:53:15.372 INFO: Average number of neighbors: 16.712
2024-11-14 12:53:15.372 INFO: Building model
2024-11-14 12:53:18.004 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 12:53:18.006 INFO: Number of parameters: 2803984
2024-11-14 12:53:18.006 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 12:53:18.006 INFO: Started training
2024-11-14 12:53:33.347 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 12:53:33.555 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 12:53:33.555 INFO: Loading 3BPA dataset
2024-11-14 12:53:37.466 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 12:53:37.468 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 12:53:38.354 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 12:53:38.409 INFO: Average number of neighbors: 16.712
2024-11-14 12:53:38.410 INFO: Building model
2024-11-14 12:53:40.996 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 12:53:40.998 INFO: Number of parameters: 2803984
2024-11-14 12:53:40.998 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 12:53:40.998 INFO: Started training
2024-11-14 12:53:42.450 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.123e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=2.265e-08 in argument 0
2024-11-14 12:53:42.611 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=0.000e+00 in argument 0
(parity_k=1, did_translate=False) -> max error=0.000e+00 in argument 0
2024-11-14 12:53:58.768 INFO: Epoch 0: loss=81.2449
2024-11-14 12:54:14.930 INFO: Epoch 2: loss=21.0319
2024-11-14 12:54:31.225 INFO: Epoch 4: loss=15.8813
2024-11-14 12:54:47.528 INFO: Epoch 6: loss=13.2248
2024-11-14 12:55:03.882 INFO: Epoch 8: loss=11.8746
2024-11-14 12:55:20.250 INFO: Epoch 10: loss=10.5534
2024-11-14 12:55:36.642 INFO: Epoch 12: loss=9.7366
2024-11-14 12:55:49.378 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 12:55:49.591 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 12:55:49.591 INFO: Loading 3BPA dataset
2024-11-14 12:55:53.774 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 12:55:53.776 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 12:55:54.659 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 12:55:54.715 INFO: Average number of neighbors: 16.712
2024-11-14 12:55:54.715 INFO: Building model
2024-11-14 12:55:57.372 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 12:55:57.374 INFO: Number of parameters: 2803984
2024-11-14 12:55:57.374 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 12:55:57.374 INFO: Started training
2024-11-14 12:55:58.849 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=2.598e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=1.385e-07 in argument 0
2024-11-14 12:55:59.043 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=0.000e+00 in argument 0
(parity_k=1, did_translate=False) -> max error=0.000e+00 in argument 0
2024-11-14 12:56:17.321 INFO: Epoch 0: loss=110.7257
2024-11-14 12:56:37.606 INFO: Epoch 2: loss=23.9197
2024-11-14 12:56:57.924 INFO: Epoch 4: loss=16.6823
2024-11-14 12:57:18.256 INFO: Epoch 6: loss=13.4379
2024-11-14 12:57:38.573 INFO: Epoch 8: loss=11.9607
2024-11-14 12:57:58.895 INFO: Epoch 10: loss=10.5333
2024-11-14 12:58:19.205 INFO: Epoch 12: loss=9.6497
2024-11-14 12:58:39.538 INFO: Epoch 14: loss=8.9085
2024-11-14 12:58:59.825 INFO: Epoch 16: loss=8.3502
2024-11-14 12:59:20.118 INFO: Epoch 18: loss=7.8857
2024-11-14 12:59:40.400 INFO: Epoch 20: loss=7.3952
2024-11-14 13:00:00.686 INFO: Epoch 22: loss=6.9704
2024-11-14 13:00:20.975 INFO: Epoch 24: loss=6.7154
2024-11-14 13:00:50.738 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 13:00:50.947 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 13:00:50.947 INFO: Loading 3BPA dataset
2024-11-14 13:00:54.793 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 13:00:54.795 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 13:00:55.686 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 13:00:55.741 INFO: Average number of neighbors: 16.712
2024-11-14 13:00:55.741 INFO: Building model
2024-11-14 13:00:58.352 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 13:00:58.354 INFO: Number of parameters: 2803984
2024-11-14 13:00:58.354 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 13:00:58.354 INFO: Started training
2024-11-14 13:00:59.818 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.716e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=7.050e-08 in argument 0
2024-11-14 13:00:59.980 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=0.000e+00 in argument 0
(parity_k=1, did_translate=False) -> max error=0.000e+00 in argument 0
2024-11-14 13:01:43.975 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 13:01:44.197 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 13:01:44.198 INFO: Loading 3BPA dataset
2024-11-14 13:01:48.229 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 13:01:48.231 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 13:01:49.126 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 13:01:49.185 INFO: Average number of neighbors: 16.712
2024-11-14 13:01:49.185 INFO: Building model
2024-11-14 13:01:51.855 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 13:01:51.856 INFO: Number of parameters: 2803984
2024-11-14 13:01:51.856 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 13:01:51.856 INFO: Started training
2024-11-14 13:01:53.312 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.177e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=9.630e-09 in argument 0
2024-11-14 13:01:53.474 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=0.000e+00 in argument 0
(parity_k=1, did_translate=False) -> max error=0.000e+00 in argument 0
2024-11-14 13:02:09.653 INFO: Epoch 0: loss=74.1919
2024-11-14 13:02:25.836 INFO: Epoch 2: loss=21.2598
2024-11-14 13:02:42.082 INFO: Epoch 4: loss=15.9029
2024-11-14 13:02:58.376 INFO: Epoch 6: loss=13.2111
2024-11-14 13:03:14.725 INFO: Epoch 8: loss=11.8555
2024-11-14 13:03:31.092 INFO: Epoch 10: loss=10.5288
2024-11-14 13:03:47.461 INFO: Epoch 12: loss=9.7383
2024-11-14 13:04:03.834 INFO: Epoch 14: loss=8.9829
2024-11-14 13:04:20.203 INFO: Epoch 16: loss=8.3943
2024-11-14 13:04:36.582 INFO: Epoch 18: loss=7.8805
2024-11-14 13:04:52.954 INFO: Epoch 20: loss=7.3818
2024-11-14 13:05:09.333 INFO: Epoch 22: loss=6.9227
2024-11-14 13:05:25.710 INFO: Epoch 24: loss=6.6335
2024-11-14 13:05:42.141 INFO: Epoch 26: loss=6.3462
2024-11-14 13:05:58.522 INFO: Epoch 28: loss=6.0273
2024-11-14 13:06:14.897 INFO: Epoch 30: loss=5.8005
2024-11-14 13:06:31.277 INFO: Epoch 32: loss=5.6276
2024-11-14 13:06:47.654 INFO: Epoch 34: loss=5.4422
2024-11-14 13:07:04.029 INFO: Epoch 36: loss=5.3121
2024-11-14 13:07:20.406 INFO: Epoch 38: loss=5.1183
2024-11-14 13:07:36.784 INFO: Epoch 40: loss=4.9402
2024-11-14 13:07:53.166 INFO: Epoch 42: loss=4.8458
2024-11-14 13:08:09.544 INFO: Epoch 44: loss=4.6695
2024-11-14 13:08:25.917 INFO: Epoch 46: loss=4.5464
2024-11-14 13:08:42.284 INFO: Epoch 48: loss=4.3221
2024-11-14 13:08:58.644 INFO: Epoch 50: loss=4.2426
2024-11-14 13:09:15.013 INFO: Epoch 52: loss=4.1113
2024-11-14 13:09:31.373 INFO: Epoch 54: loss=3.9379
2024-11-14 13:09:47.732 INFO: Epoch 56: loss=3.8293
2024-11-14 13:10:04.084 INFO: Epoch 58: loss=3.6967
2024-11-14 13:10:20.432 INFO: Epoch 60: loss=3.6079
2024-11-14 13:10:36.785 INFO: Epoch 62: loss=3.4889
2024-11-14 13:10:53.137 INFO: Epoch 64: loss=3.3704
2024-11-14 13:11:09.485 INFO: Epoch 66: loss=3.2655
2024-11-14 13:11:25.829 INFO: Epoch 68: loss=3.2006
2024-11-14 13:11:42.176 INFO: Epoch 70: loss=3.1228
2024-11-14 13:11:58.520 INFO: Epoch 72: loss=3.0428
2024-11-14 13:12:14.869 INFO: Epoch 74: loss=2.9712
2024-11-14 13:12:31.208 INFO: Epoch 76: loss=2.8907
2024-11-14 13:12:47.556 INFO: Epoch 78: loss=2.8341
2024-11-14 13:13:03.900 INFO: Epoch 80: loss=2.7954
2024-11-14 13:13:20.238 INFO: Epoch 82: loss=2.7086
2024-11-14 13:13:36.568 INFO: Epoch 84: loss=2.6761
2024-11-14 13:13:52.908 INFO: Epoch 86: loss=2.6323
2024-11-14 13:14:09.317 INFO: Epoch 88: loss=2.5643
2024-11-14 13:14:25.655 INFO: Epoch 90: loss=2.5273
2024-11-14 13:14:41.990 INFO: Epoch 92: loss=2.4785
2024-11-14 13:14:58.322 INFO: Epoch 94: loss=2.4472
2024-11-14 13:15:14.657 INFO: Epoch 96: loss=2.3852
2024-11-14 13:15:30.989 INFO: Epoch 98: loss=2.3266
2024-11-14 13:15:47.333 INFO: Epoch 100: loss=2.3169
2024-11-14 13:16:03.668 INFO: Epoch 102: loss=2.2785
2024-11-14 13:16:20.009 INFO: Epoch 104: loss=2.2229
2024-11-14 13:16:36.348 INFO: Epoch 106: loss=2.2069
2024-11-14 13:16:52.680 INFO: Epoch 108: loss=2.1925
2024-11-14 13:17:09.016 INFO: Epoch 110: loss=2.1685
2024-11-14 13:17:25.345 INFO: Epoch 112: loss=2.1276
2024-11-14 13:17:41.676 INFO: Epoch 114: loss=2.1015
2024-11-14 13:17:58.021 INFO: Epoch 116: loss=2.0931
2024-11-14 13:18:14.355 INFO: Epoch 118: loss=2.0652
2024-11-14 13:18:30.686 INFO: Epoch 120: loss=2.0539
2024-11-14 13:18:47.016 INFO: Epoch 122: loss=2.0295
2024-11-14 13:19:03.352 INFO: Epoch 124: loss=2.0066
2024-11-14 13:19:19.689 INFO: Epoch 126: loss=1.9960
2024-11-14 13:19:36.025 INFO: Epoch 128: loss=1.9727
2024-11-14 13:19:52.357 INFO: Epoch 130: loss=1.9400
2024-11-14 13:20:12.512 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 13:20:12.724 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 13:20:12.724 INFO: Loading 3BPA dataset
2024-11-14 13:20:16.761 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 13:20:16.763 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 13:20:17.375 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 13:20:17.417 INFO: Average number of neighbors: 16.712
2024-11-14 13:20:17.417 INFO: Building model
2024-11-14 13:20:20.093 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 13:20:20.095 INFO: Number of parameters: 2803984
2024-11-14 13:20:20.095 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 13:20:20.095 INFO: Started training
2024-11-14 13:20:21.583 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.212e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=1.667e-08 in argument 0
2024-11-14 13:20:21.779 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.863e-09 in argument 0
(parity_k=1, did_translate=False) -> max error=1.863e-09 in argument 0
2024-11-14 13:20:45.557 INFO: Epoch 0: loss=53.6211
2024-11-14 13:21:17.007 INFO: Epoch 2: loss=8.8121
2024-11-14 13:21:48.488 INFO: Epoch 4: loss=5.1439
2024-11-14 13:22:19.981 INFO: Epoch 6: loss=3.8297
2024-11-14 13:22:51.468 INFO: Epoch 8: loss=2.9898
2024-11-14 13:23:22.951 INFO: Epoch 10: loss=2.4585
2024-11-14 13:23:54.435 INFO: Epoch 12: loss=2.0541
2024-11-14 13:24:25.914 INFO: Epoch 14: loss=1.7746
2024-11-14 13:24:57.402 INFO: Epoch 16: loss=1.5585
2024-11-14 13:25:28.884 INFO: Epoch 18: loss=1.3735
2024-11-14 13:26:00.360 INFO: Epoch 20: loss=1.2672
2024-11-14 13:26:31.832 INFO: Epoch 22: loss=1.1469
2024-11-14 13:27:03.306 INFO: Epoch 24: loss=1.0672
2024-11-14 13:27:34.785 INFO: Epoch 26: loss=0.9793
2024-11-14 13:36:25.916 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 13:36:26.123 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 13:36:26.123 INFO: Loading 3BPA dataset
2024-11-14 13:36:30.143 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 13:36:30.145 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 13:36:30.738 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 13:36:30.777 INFO: Average number of neighbors: 16.712
2024-11-14 13:36:30.777 INFO: Building model
2024-11-14 13:36:33.393 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 13:36:33.395 INFO: Number of parameters: 2803984
2024-11-14 13:36:33.395 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 13:36:33.395 INFO: Started training
2024-11-14 13:36:34.909 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.223e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=1.419e-08 in argument 0
2024-11-14 13:36:35.105 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.863e-09 in argument 0
(parity_k=1, did_translate=False) -> max error=1.863e-09 in argument 0
2024-11-14 13:37:01.330 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 13:37:01.551 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 13:37:01.552 INFO: Loading 3BPA dataset
2024-11-14 13:37:05.355 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 13:37:05.357 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 13:37:06.242 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 13:37:06.297 INFO: Average number of neighbors: 16.712
2024-11-14 13:37:06.297 INFO: Building model
2024-11-14 13:37:08.946 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 13:37:08.947 INFO: Number of parameters: 2803984
2024-11-14 13:37:08.947 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 13:37:08.947 INFO: Started training
2024-11-14 13:37:10.448 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.217e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=1.613e-08 in argument 0
2024-11-14 13:37:10.646 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.863e-09 in argument 0
(parity_k=1, did_translate=False) -> max error=1.863e-09 in argument 0
2024-11-14 13:37:34.335 INFO: Epoch 0: loss=53.6212
2024-11-14 13:38:11.045 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 13:38:11.275 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 13:38:11.276 INFO: Loading 3BPA dataset
2024-11-14 13:38:15.206 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 13:38:15.208 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 13:38:15.787 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 13:38:15.828 INFO: Average number of neighbors: 16.712
2024-11-14 13:38:15.828 INFO: Building model
2024-11-14 13:38:18.477 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 13:38:18.478 INFO: Number of parameters: 2803984
2024-11-14 13:38:18.479 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 13:38:18.479 INFO: Started training
2024-11-14 13:38:19.988 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.907e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=2.104e-08 in argument 0
2024-11-14 13:38:20.227 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.863e-09 in argument 0
(parity_k=1, did_translate=False) -> max error=1.863e-09 in argument 0
2024-11-14 13:38:56.306 INFO: Epoch 0: loss=52.7351
2024-11-14 13:39:51.362 INFO: Epoch 2: loss=8.8306
2024-11-14 13:40:39.395 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 13:40:39.606 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 13:40:39.606 INFO: Loading 3BPA dataset
2024-11-14 13:40:43.716 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 13:40:43.719 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 13:40:44.617 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 13:40:44.677 INFO: Average number of neighbors: 16.712
2024-11-14 13:40:44.677 INFO: Building model
2024-11-14 13:40:47.472 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 13:40:47.474 INFO: Number of parameters: 2803984
2024-11-14 13:40:47.474 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 13:40:47.474 INFO: Started training
2024-11-14 13:40:49.186 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.683e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=1.572e-08 in argument 0
2024-11-14 13:40:49.422 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=26x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=26x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=38x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=38x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=38x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=3.725e-09 in argument 0
(parity_k=1, did_translate=False) -> max error=1.863e-09 in argument 0
2024-11-14 13:41:25.944 INFO: Epoch 0: loss=52.7350
2024-11-14 13:42:21.887 INFO: Epoch 2: loss=8.8306
2024-11-14 13:43:17.866 INFO: Epoch 4: loss=5.1419
2024-11-14 13:44:13.768 INFO: Epoch 6: loss=3.6913
2024-11-14 13:45:09.666 INFO: Epoch 8: loss=2.8342
2024-11-14 13:46:05.569 INFO: Epoch 10: loss=2.3002
2024-11-14 13:47:01.480 INFO: Epoch 12: loss=1.9075
2024-11-14 13:47:57.423 INFO: Epoch 14: loss=1.6325
2024-11-14 13:48:53.319 INFO: Epoch 16: loss=1.4281
2024-11-14 13:49:14.667 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 13:49:14.881 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 13:49:14.881 INFO: Loading 3BPA dataset
2024-11-14 13:49:18.909 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 13:49:18.911 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 13:49:19.493 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 13:49:19.536 INFO: Average number of neighbors: 16.712
2024-11-14 13:49:19.536 INFO: Building model
2024-11-14 13:49:22.271 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=14x7 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=14x7 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=14x7 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=20x10 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=20x10 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=20x10 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=14x7 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=14x7 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=14x7 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=20x10 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=20x10 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=20x10 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 13:49:22.273 INFO: Number of parameters: 2803984
2024-11-14 13:49:22.273 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 13:49:22.273 INFO: Started training
2024-11-14 13:49:23.751 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=14x7 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=14x7 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=14x7 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=20x10 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=20x10 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=20x10 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=3.680e-03 in argument 0
(parity_k=1, did_translate=False) -> max error=2.211e-03 in argument 0
2024-11-14 13:49:43.088 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 13:49:43.296 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 13:49:43.296 INFO: Loading 3BPA dataset
2024-11-14 13:49:47.090 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 13:49:47.092 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 13:49:47.984 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 13:49:48.040 INFO: Average number of neighbors: 16.712
2024-11-14 13:49:48.040 INFO: Building model
2024-11-14 13:49:50.719 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=14x7 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=14x7 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=14x7 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=20x10 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=20x10 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=20x10 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=14x7 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=14x7 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=14x7 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=20x10 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=20x10 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=20x10 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 13:49:50.721 INFO: Number of parameters: 2803984
2024-11-14 13:49:50.721 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 13:49:50.721 INFO: Started training
2024-11-14 13:50:10.410 INFO: Epoch 0: loss=53.1088
2024-11-14 13:50:32.095 INFO: Epoch 2: loss=8.8133
2024-11-14 13:50:53.849 INFO: Epoch 4: loss=5.2455
2024-11-14 13:51:15.651 INFO: Epoch 6: loss=3.7460
2024-11-14 13:51:37.476 INFO: Epoch 8: loss=2.8950
2024-11-14 13:51:59.317 INFO: Epoch 10: loss=2.3730
2024-11-14 13:52:21.165 INFO: Epoch 12: loss=2.0187
2024-11-14 13:52:37.698 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 13:52:37.914 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 13:52:37.915 INFO: Loading 3BPA dataset
2024-11-14 13:52:41.918 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 13:52:41.920 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 13:52:42.810 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 13:52:42.865 INFO: Average number of neighbors: 16.712
2024-11-14 13:52:42.865 INFO: Building model
2024-11-14 13:52:45.520 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=14x7 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=14x7 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=14x7 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=20x10 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=20x10 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=20x10 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=14x7 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=14x7 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=14x7 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=20x10 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=20x10 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=20x10 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 13:52:45.522 INFO: Number of parameters: 2803984
2024-11-14 13:52:45.522 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 13:52:45.522 INFO: Started training
2024-11-14 13:53:05.311 INFO: Epoch 0: loss=53.1088
2024-11-14 13:53:27.192 INFO: Epoch 2: loss=8.8133
2024-11-14 13:53:49.095 INFO: Epoch 4: loss=5.2455
2024-11-14 13:54:10.998 INFO: Epoch 6: loss=3.7460
2024-11-14 13:54:32.929 INFO: Epoch 8: loss=2.8950
2024-11-14 13:54:54.837 INFO: Epoch 10: loss=2.3730
2024-11-14 13:55:16.761 INFO: Epoch 12: loss=2.0187
2024-11-14 13:55:38.746 INFO: Epoch 14: loss=1.7594
2024-11-14 13:56:00.675 INFO: Epoch 16: loss=1.5356
2024-11-14 13:56:27.603 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 13:56:27.831 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 13:56:27.831 INFO: Loading 3BPA dataset
2024-11-14 13:56:31.647 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 13:56:31.649 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 13:56:32.538 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 13:56:32.594 INFO: Average number of neighbors: 16.712
2024-11-14 13:56:32.594 INFO: Building model
2024-11-14 13:56:35.196 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 13:56:35.197 INFO: Number of parameters: 2803984
2024-11-14 13:56:35.197 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 13:56:35.197 INFO: Started training
2024-11-14 13:56:44.142 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 13:56:44.365 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 13:56:44.365 INFO: Loading 3BPA dataset
2024-11-14 13:56:48.454 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 13:56:48.456 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 13:56:49.348 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 13:56:49.408 INFO: Average number of neighbors: 16.712
2024-11-14 13:56:49.408 INFO: Building model
2024-11-14 13:56:52.140 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (gaunt_s2grid): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 13:56:52.141 INFO: Number of parameters: 2803984
2024-11-14 13:56:52.141 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 13:56:52.141 INFO: Started training
2024-11-14 13:56:53.621 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.683e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=2.146e-08 in argument 0
2024-11-14 13:56:53.815 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductGauntS2Grid.forward of EfficientMultiTensorProductGauntS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (gaunt_s2grid): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=9.313e-10 in argument 0
(parity_k=1, did_translate=False) -> max error=9.313e-10 in argument 0
2024-11-14 13:57:20.132 INFO: Epoch 0: loss=52.7350
2024-11-14 13:57:56.559 INFO: Epoch 2: loss=8.8306
2024-11-14 13:58:33.052 INFO: Epoch 4: loss=5.1420
2024-11-14 13:59:09.556 INFO: Epoch 6: loss=3.6913
2024-11-14 13:59:46.054 INFO: Epoch 8: loss=2.8342
2024-11-14 14:00:22.547 INFO: Epoch 10: loss=2.3002
2024-11-14 14:00:59.032 INFO: Epoch 12: loss=1.9075
2024-11-14 14:01:35.519 INFO: Epoch 14: loss=1.6325
2024-11-14 14:02:12.004 INFO: Epoch 16: loss=1.4281
2024-11-14 14:02:48.560 INFO: Epoch 18: loss=1.2498
2024-11-14 14:03:25.043 INFO: Epoch 20: loss=1.1401
2024-11-14 14:04:01.527 INFO: Epoch 22: loss=1.0326
2024-11-14 14:04:38.005 INFO: Epoch 24: loss=0.9518
2024-11-14 14:05:14.491 INFO: Epoch 26: loss=0.8761
2024-11-14 14:05:51.029 INFO: Epoch 28: loss=0.8060
2024-11-14 14:06:27.518 INFO: Epoch 30: loss=0.7489
2024-11-14 14:07:04.013 INFO: Epoch 32: loss=0.7013
2024-11-14 14:07:40.498 INFO: Epoch 34: loss=0.6740
2024-11-14 14:08:16.985 INFO: Epoch 36: loss=0.6359
2024-11-14 14:08:53.469 INFO: Epoch 38: loss=0.6036
2024-11-14 14:09:29.954 INFO: Epoch 40: loss=0.5677
2024-11-14 14:10:06.452 INFO: Epoch 42: loss=0.5428
2024-11-14 14:10:42.925 INFO: Epoch 44: loss=0.5252
2024-11-14 14:11:19.407 INFO: Epoch 46: loss=0.4944
2024-11-14 14:11:55.891 INFO: Epoch 48: loss=0.4749
2024-11-14 14:12:32.367 INFO: Epoch 50: loss=0.4543
2024-11-14 14:13:08.849 INFO: Epoch 52: loss=0.4392
2024-11-14 14:13:45.321 INFO: Epoch 54: loss=0.4297
2024-11-14 14:14:21.796 INFO: Epoch 56: loss=0.4173
2024-11-14 14:14:58.281 INFO: Epoch 58: loss=0.4028
2024-11-14 14:15:34.755 INFO: Epoch 60: loss=0.3975
2024-11-14 14:16:11.231 INFO: Epoch 62: loss=0.3817
2024-11-14 14:16:47.705 INFO: Epoch 64: loss=0.3678
2024-11-14 14:17:24.175 INFO: Epoch 66: loss=0.3606
2024-11-14 14:18:00.645 INFO: Epoch 68: loss=0.3487
2024-11-14 14:18:37.118 INFO: Epoch 70: loss=0.3419
2024-11-14 14:19:13.588 INFO: Epoch 72: loss=0.3325
2024-11-14 14:19:50.065 INFO: Epoch 74: loss=0.3254
2024-11-14 14:20:26.529 INFO: Epoch 76: loss=0.3194
2024-11-14 14:21:03.000 INFO: Epoch 78: loss=0.3121
2024-11-14 14:21:39.471 INFO: Epoch 80: loss=0.3034
2024-11-14 14:22:15.943 INFO: Epoch 82: loss=0.2962
2024-11-14 14:22:52.408 INFO: Epoch 84: loss=0.2973
2024-11-14 14:23:28.815 INFO: Epoch 86: loss=0.2909
2024-11-14 14:24:05.300 INFO: Epoch 88: loss=0.2864
2024-11-14 14:24:41.785 INFO: Epoch 90: loss=0.2813
2024-11-14 14:25:18.259 INFO: Epoch 92: loss=0.2760
2024-11-14 14:25:54.735 INFO: Epoch 94: loss=0.2705
2024-11-14 14:26:31.214 INFO: Epoch 96: loss=0.2660
2024-11-14 14:27:07.691 INFO: Epoch 98: loss=0.2632
2024-11-14 14:27:44.168 INFO: Epoch 100: loss=0.2616
2024-11-14 14:28:20.646 INFO: Epoch 102: loss=0.2580
2024-11-14 14:28:57.121 INFO: Epoch 104: loss=0.2543
2024-11-14 14:29:33.603 INFO: Epoch 106: loss=0.2494
2024-11-14 14:30:10.078 INFO: Epoch 108: loss=0.2476
2024-11-14 14:30:46.563 INFO: Epoch 110: loss=0.2450
2024-11-14 14:31:23.030 INFO: Epoch 112: loss=0.2424
2024-11-14 14:31:59.492 INFO: Epoch 114: loss=0.2398
2024-11-14 14:32:35.960 INFO: Epoch 116: loss=0.2370
2024-11-14 14:33:12.431 INFO: Epoch 118: loss=0.2340
2024-11-14 14:33:48.891 INFO: Epoch 120: loss=0.2299
2024-11-14 14:34:25.366 INFO: Epoch 122: loss=0.2300
2024-11-14 14:35:01.773 INFO: Epoch 124: loss=0.2283
2024-11-14 14:35:38.245 INFO: Epoch 126: loss=0.2252
2024-11-14 14:36:14.726 INFO: Epoch 128: loss=0.2242
2024-11-14 14:36:51.204 INFO: Epoch 130: loss=0.2235
2024-11-14 14:37:27.773 INFO: Epoch 132: loss=0.2199
2024-11-14 14:38:04.256 INFO: Epoch 134: loss=0.2180
2024-11-14 14:38:40.722 INFO: Epoch 136: loss=0.2149
2024-11-14 14:39:17.200 INFO: Epoch 138: loss=0.2124
2024-11-14 14:39:53.668 INFO: Epoch 140: loss=0.2104
2024-11-14 14:40:30.140 INFO: Epoch 142: loss=0.2116
2024-11-14 14:41:06.549 INFO: Epoch 144: loss=0.2103
2024-11-14 14:41:43.019 INFO: Epoch 146: loss=0.2060
2024-11-14 14:42:19.487 INFO: Epoch 148: loss=0.2046
2024-11-14 14:42:55.961 INFO: Epoch 150: loss=0.2037
2024-11-14 14:43:32.431 INFO: Epoch 152: loss=0.2020
2024-11-14 14:44:08.901 INFO: Epoch 154: loss=0.1992
2024-11-14 14:44:45.370 INFO: Epoch 156: loss=0.1977
2024-11-14 14:45:21.837 INFO: Epoch 158: loss=0.1974
2024-11-14 14:45:58.303 INFO: Epoch 160: loss=0.1951
2024-11-14 14:46:34.768 INFO: Epoch 162: loss=0.1939
2024-11-14 14:47:11.233 INFO: Epoch 164: loss=0.1928
2024-11-14 14:47:47.704 INFO: Epoch 166: loss=0.1924
2024-11-14 14:48:24.208 INFO: Epoch 168: loss=0.1908
2024-11-14 14:49:00.679 INFO: Epoch 170: loss=0.1911
2024-11-14 14:49:37.086 INFO: Epoch 172: loss=0.1899
2024-11-14 14:50:13.557 INFO: Epoch 174: loss=0.1868
2024-11-14 14:50:50.032 INFO: Epoch 176: loss=0.1839
2024-11-14 14:51:26.507 INFO: Epoch 178: loss=0.1818
2024-11-14 14:52:02.984 INFO: Epoch 180: loss=0.1818
2024-11-14 14:52:39.398 INFO: Epoch 182: loss=0.1811
2024-11-14 14:53:15.868 INFO: Epoch 184: loss=0.1814
2024-11-14 14:53:52.289 INFO: Epoch 186: loss=0.1797
2024-11-14 14:54:28.771 INFO: Epoch 188: loss=0.1783
2024-11-14 14:55:05.254 INFO: Epoch 190: loss=0.1776
2024-11-14 14:55:41.738 INFO: Epoch 192: loss=0.1762
2024-11-14 14:56:18.219 INFO: Epoch 194: loss=0.1760
2024-11-14 14:56:54.699 INFO: Epoch 196: loss=0.1752
2024-11-14 14:57:31.181 INFO: Epoch 198: loss=0.1744
2024-11-14 14:58:07.660 INFO: Epoch 200: loss=0.1732
2024-11-14 14:58:44.149 INFO: Epoch 202: loss=0.1722
2024-11-14 14:59:20.624 INFO: Epoch 204: loss=0.1715
2024-11-14 14:59:57.105 INFO: Epoch 206: loss=0.1702
2024-11-14 15:00:33.596 INFO: Epoch 208: loss=0.1694
2024-11-14 15:01:10.076 INFO: Epoch 210: loss=0.1686
2024-11-14 15:01:46.556 INFO: Epoch 212: loss=0.1680
2024-11-14 15:02:23.032 INFO: Epoch 214: loss=0.1659
2024-11-14 15:02:59.510 INFO: Epoch 216: loss=0.1656
2024-11-14 15:03:35.990 INFO: Epoch 218: loss=0.1654
2024-11-14 15:04:12.465 INFO: Epoch 220: loss=0.1639
2024-11-14 15:04:48.941 INFO: Epoch 222: loss=0.1649
2024-11-14 15:05:25.359 INFO: Epoch 224: loss=0.1629
2024-11-14 15:06:01.830 INFO: Epoch 226: loss=0.1618
2024-11-14 15:06:38.308 INFO: Epoch 228: loss=0.1616
2024-11-14 15:07:14.782 INFO: Epoch 230: loss=0.1610
2024-11-14 15:07:51.243 INFO: Epoch 232: loss=0.1583
2024-11-14 15:08:27.725 INFO: Epoch 234: loss=0.1577
2024-11-14 15:09:04.205 INFO: Epoch 236: loss=0.1584
2024-11-14 15:09:40.619 INFO: Epoch 238: loss=0.1564
2024-11-14 15:10:17.109 INFO: Epoch 240: loss=0.1568
2024-11-14 15:10:53.529 INFO: Epoch 242: loss=0.1573
2024-11-14 15:11:29.949 INFO: Epoch 244: loss=0.1558
2024-11-14 15:12:06.431 INFO: Epoch 246: loss=0.1543
2024-11-14 18:04:22.376 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 18:04:22.477 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 18:04:22.477 INFO: Loading 3BPA dataset
2024-11-14 18:04:26.257 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 18:04:26.259 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 18:04:27.149 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 18:04:27.205 INFO: Average number of neighbors: 16.712
2024-11-14 18:04:27.205 INFO: Building model
2024-11-14 18:07:23.390 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 18:07:23.500 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 18:07:23.500 INFO: Loading 3BPA dataset
2024-11-14 18:07:27.643 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 18:07:27.645 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 18:07:28.494 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 18:07:28.551 INFO: Average number of neighbors: 16.712
2024-11-14 18:07:28.551 INFO: Building model
2024-11-14 18:07:40.251 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductVectorGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (vector_gaunt_s2grid): ModuleDict(
          (1): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=14x13 (beta x alpha))
            )
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=14x13 (beta x alpha))
            )
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=6 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
            )
          )
          (2): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=6 res=20x19 (beta x alpha))
            )
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=20x19 (beta x alpha))
            )
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=9 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
            )
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductVectorGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (vector_gaunt_s2grid): ModuleDict(
          (1): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=14x13 (beta x alpha))
            )
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=14x13 (beta x alpha))
            )
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=6 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
            )
          )
          (2): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=6 res=20x19 (beta x alpha))
            )
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=20x19 (beta x alpha))
            )
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=9 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
            )
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 18:07:40.253 INFO: Number of parameters: 2803984
2024-11-14 18:07:40.253 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 18:07:40.254 INFO: Started training
2024-11-14 18:07:52.379 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 18:07:52.490 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 18:07:52.490 INFO: Loading 3BPA dataset
2024-11-14 18:07:56.548 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 18:07:56.550 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 18:07:57.450 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 18:07:57.510 INFO: Average number of neighbors: 16.712
2024-11-14 18:07:57.510 INFO: Building model
2024-11-14 18:08:09.042 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductVectorGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (vector_gaunt_s2grid): ModuleDict(
          (1): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=14x13 (beta x alpha))
            )
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=14x13 (beta x alpha))
            )
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=6 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
            )
          )
          (2): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=6 res=20x19 (beta x alpha))
            )
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=20x19 (beta x alpha))
            )
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=9 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
            )
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductVectorGauntS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (vector_gaunt_s2grid): ModuleDict(
          (1): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=14x13 (beta x alpha))
            )
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=14x13 (beta x alpha))
            )
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=6 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
            )
          )
          (2): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=6 res=20x19 (beta x alpha))
            )
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=20x19 (beta x alpha))
            )
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=9 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
            )
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 18:08:09.044 INFO: Number of parameters: 2803984
2024-11-14 18:08:09.044 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 18:08:09.044 INFO: Started training
2024-11-14 18:13:52.374 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 18:13:52.488 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 18:13:52.488 INFO: Loading 3BPA dataset
2024-11-14 18:13:56.279 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 18:13:56.281 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 18:13:57.166 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 18:13:57.222 INFO: Average number of neighbors: 16.712
2024-11-14 18:13:57.222 INFO: Building model
2024-11-14 18:14:08.929 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (tps): ModuleDict(
          (1): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=14x13 (beta x alpha))
            )
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=14x13 (beta x alpha))
            )
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=6 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
            )
          )
          (2): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=6 res=20x19 (beta x alpha))
            )
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=20x19 (beta x alpha))
            )
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=9 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
            )
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (tps): ModuleDict(
          (1): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=14x13 (beta x alpha))
            )
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=14x13 (beta x alpha))
            )
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=6 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
            )
          )
          (2): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=6 res=20x19 (beta x alpha))
            )
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=3 res=20x19 (beta x alpha))
            )
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=9 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
            )
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 18:14:08.931 INFO: Number of parameters: 2803984
2024-11-14 18:14:08.931 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 18:14:08.931 INFO: Started training
2024-11-14 18:14:57.842 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 18:14:57.944 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 18:14:57.945 INFO: Loading 3BPA dataset
2024-11-14 18:15:01.681 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 18:15:01.683 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 18:15:02.322 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 18:15:02.361 INFO: Average number of neighbors: 16.712
2024-11-14 18:15:02.361 INFO: Building model
2024-11-14 18:17:56.733 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 18:17:56.847 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 18:17:56.848 INFO: Loading 3BPA dataset
2024-11-14 18:18:00.857 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 18:18:00.859 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 18:18:01.436 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 18:18:01.477 INFO: Average number of neighbors: 16.712
2024-11-14 18:18:01.477 INFO: Building model
2024-11-14 18:18:11.796 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (tps): ModuleDict(
          (1): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=14x13 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e | 11 weights)
          )
          (2): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=20x19 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e -> 1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e | 11 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=20x19 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=8 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=8 res=20x19 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+2x5o+1x5e+1x6o+2x6e+2x7o+1x7e+1x8o+1x8e+1x9o -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e+1x7o+1x8e+1x9o | 17 weights)
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (tps): ModuleDict(
          (1): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=14x13 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e | 11 weights)
          )
          (2): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=20x19 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e -> 1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e | 11 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=20x19 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=8 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=8 res=20x19 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+2x5o+1x5e+1x6o+2x6e+2x7o+1x7e+1x8o+1x8e+1x9o -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e+1x7o+1x8e+1x9o | 17 weights)
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 18:18:11.799 INFO: Number of parameters: 2804092
2024-11-14 18:18:11.799 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 18:18:11.799 INFO: Started training
2024-11-14 18:19:56.862 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 18:19:56.983 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 18:19:56.983 INFO: Loading 3BPA dataset
2024-11-14 18:20:00.969 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 18:20:00.971 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 18:20:01.563 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 18:20:01.604 INFO: Average number of neighbors: 16.712
2024-11-14 18:20:01.604 INFO: Building model
2024-11-14 18:20:56.777 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 18:20:56.886 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 18:20:56.886 INFO: Loading 3BPA dataset
2024-11-14 18:21:00.911 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 18:21:00.913 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 18:21:01.821 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 18:21:01.883 INFO: Average number of neighbors: 16.712
2024-11-14 18:21:01.883 INFO: Building model
2024-11-14 18:21:05.410 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (tps): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (tps): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 18:21:05.411 INFO: Number of parameters: 2803984
2024-11-14 18:21:05.411 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 18:21:05.411 INFO: Started training
2024-11-14 18:21:06.251 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductS2Grid.forward of EfficientMultiTensorProductS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (tps): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.683e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=1.600e-08 in argument 0
2024-11-14 18:21:06.436 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductS2Grid.forward of EfficientMultiTensorProductS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (tps): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.863e-09 in argument 0
(parity_k=1, did_translate=False) -> max error=9.313e-10 in argument 0
2024-11-14 18:21:23.083 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 18:21:23.193 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 18:21:23.194 INFO: Loading 3BPA dataset
2024-11-14 18:21:27.334 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 18:21:27.336 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 18:21:28.218 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 18:21:28.274 INFO: Average number of neighbors: 16.712
2024-11-14 18:21:28.274 INFO: Building model
2024-11-14 18:21:37.475 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 18:21:37.581 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 18:21:37.581 INFO: Loading 3BPA dataset
2024-11-14 18:21:41.368 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 18:21:41.370 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 18:21:42.202 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 18:21:42.263 INFO: Average number of neighbors: 16.712
2024-11-14 18:21:42.263 INFO: Building model
2024-11-14 18:21:45.622 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (tps): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (tps): ModuleDict(
          (1): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
          )
          (2): GauntTensorProductS2Grid(
            (to_s2grid1): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
            (to_s2grid2): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
            (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 18:21:45.624 INFO: Number of parameters: 2803984
2024-11-14 18:21:45.624 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 18:21:45.624 INFO: Started training
2024-11-14 18:21:46.467 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductS2Grid.forward of EfficientMultiTensorProductS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (tps): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.683e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=1.572e-08 in argument 0
2024-11-14 18:21:46.660 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductS2Grid.forward of EfficientMultiTensorProductS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
  )
  (tps): ModuleDict(
    (1): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=14x13 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=6 res=14x13 (beta x alpha))
    )
    (2): GauntTensorProductS2Grid(
      (to_s2grid1): ToS2Grid(lmax=6 res=20x19 (beta x alpha))
      (to_s2grid2): ToS2Grid(lmax=3 res=20x19 (beta x alpha))
      (from_s2grid): FromS2Grid(lmax=9 res=20x19 (beta x alpha))
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=9.313e-10 in argument 0
(parity_k=1, did_translate=False) -> max error=9.313e-10 in argument 0
2024-11-14 18:22:13.029 INFO: Epoch 0: loss=52.7351
2024-11-14 18:22:49.466 INFO: Epoch 2: loss=8.8306
2024-11-14 18:24:37.735 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 18:24:37.845 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 18:24:37.845 INFO: Loading 3BPA dataset
2024-11-14 18:24:41.691 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 18:24:41.693 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 18:24:42.271 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 18:24:42.310 INFO: Average number of neighbors: 16.712
2024-11-14 18:24:42.311 INFO: Building model
2024-11-14 18:24:58.651 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 18:24:58.754 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 18:24:58.754 INFO: Loading 3BPA dataset
2024-11-14 18:25:02.554 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 18:25:02.556 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 18:25:03.439 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 18:25:03.494 INFO: Average number of neighbors: 16.712
2024-11-14 18:25:03.494 INFO: Building model
2024-11-14 18:25:14.316 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (tps): ModuleDict(
          (1): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=14x13 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e | 11 weights)
          )
          (2): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=20x19 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e -> 1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e | 11 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=20x19 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=8 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=8 res=20x19 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+2x5o+1x5e+1x6o+2x6e+2x7o+1x7e+1x8o+1x8e+1x9o -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e+1x7o+1x8e+1x9o | 17 weights)
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (tps): ModuleDict(
          (1): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=14x13 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e | 11 weights)
          )
          (2): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=20x19 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e -> 1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e | 11 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=20x19 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=8 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=8 res=20x19 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+2x5o+1x5e+1x6o+2x6e+2x7o+1x7e+1x8o+1x8e+1x9o -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e+1x7o+1x8e+1x9o | 17 weights)
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 18:25:14.319 INFO: Number of parameters: 2804092
2024-11-14 18:25:14.319 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 18:25:14.319 INFO: Started training
2024-11-14 18:25:15.232 INFO: Tested equivariance of `<bound method EfficientMultiTensorProductS2Grid.forward of EfficientMultiTensorProductS2Grid(
  (weights): ParameterDict(
      (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
      (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
  )
  (tps): ModuleDict(
    (1): VectorGauntTensorProductS2Grid(
      (vsh1): VectorSphericalHarmonics(
        (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
        (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
      )
      (linear1): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
      (vsh2): VectorSphericalHarmonics(
        (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
        (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
      )
      (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
      (vsh_out): VectorSphericalHarmonics(
        (to_s2grid): ToS2Grid(lmax=5 res=14x13 (beta x alpha))
        (from_s2grid): FromS2Grid(lmax=5 res=14x13 (beta x alpha))
      )
      (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e | 11 weights)
    )
    (2): VectorGauntTensorProductS2Grid(
      (vsh1): VectorSphericalHarmonics(
        (to_s2grid): ToS2Grid(lmax=5 res=20x19 (beta x alpha))
        (from_s2grid): FromS2Grid(lmax=5 res=20x19 (beta x alpha))
      )
      (linear1): Linear(1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e -> 1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e | 11 weights)
      (vsh2): VectorSphericalHarmonics(
        (to_s2grid): ToS2Grid(lmax=2 res=20x19 (beta x alpha))
        (from_s2grid): FromS2Grid(lmax=2 res=20x19 (beta x alpha))
      )
      (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
      (vsh_out): VectorSphericalHarmonics(
        (to_s2grid): ToS2Grid(lmax=8 res=20x19 (beta x alpha))
        (from_s2grid): FromS2Grid(lmax=8 res=20x19 (beta x alpha))
      )
      (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+2x5o+1x5e+1x6o+2x6e+2x7o+1x7e+1x8o+1x8e+1x9o -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e+1x7o+1x8e+1x9o | 17 weights)
    )
  )
)>` -- max componentwise errors:
(parity_k=0, did_translate=False) -> max error=1.440e-08 in argument 0
(parity_k=1, did_translate=False) -> max error=7.548e-03 in argument 0
2024-11-14 18:25:35.464 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 18:25:35.565 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 18:25:35.565 INFO: Loading 3BPA dataset
2024-11-14 18:25:39.337 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 18:25:39.339 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 18:25:40.226 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 18:25:40.281 INFO: Average number of neighbors: 16.712
2024-11-14 18:25:40.281 INFO: Building model
2024-11-14 18:25:51.148 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (tps): ModuleDict(
          (1): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=14x13 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e | 11 weights)
          )
          (2): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=20x19 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e -> 1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e | 11 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=20x19 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=8 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=8 res=20x19 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+2x5o+1x5e+1x6o+2x6e+2x7o+1x7e+1x8o+1x8e+1x9o -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e+1x7o+1x8e+1x9o | 17 weights)
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (tps): ModuleDict(
          (1): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=14x13 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e | 11 weights)
          )
          (2): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=20x19 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e -> 1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e | 11 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=20x19 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=8 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=8 res=20x19 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+2x5o+1x5e+1x6o+2x6e+2x7o+1x7e+1x8o+1x8e+1x9o -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e+1x7o+1x8e+1x9o | 17 weights)
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 18:25:51.151 INFO: Number of parameters: 2804092
2024-11-14 18:25:51.151 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 18:25:51.151 INFO: Started training
2024-11-14 18:26:47.823 INFO: Epoch 0: loss=64.9127
2024-11-14 18:28:23.742 INFO: Epoch 2: loss=16.0821
2024-11-14 18:29:59.931 INFO: Epoch 4: loss=9.0599
2024-11-14 18:30:27.117 INFO: Configuration: Namespace(name='gaunt-3bpa', seed=6, log_dir='logs', checkpoints_dir='checkpoints', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float32', log_level='INFO', model='EquivariantRealScaleShiftNonLinearBodyOrderedModel', r_max=5.0, degrees=None, num_radial_basis=8, num_cutoff_basis=5, num_radial_coupling=1, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='256x0e + 256x1o + 256x2e', gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, dataset='3bpa', subset='train_300K', split=None, loss='weighted', forces_weight=1000.0, energy_weight=1.0, optimizer='adam', batch_size=5, lr=0.01, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_partience=50, lr_scheduler_gamma=0.9993, swa=False, ema=True, ema_decay=0.99, max_num_epochs=2000, patience=256, eval_interval=2, keep_checkpoints=False, restart_latest=False)
2024-11-14 18:30:27.223 INFO: CUDA version: 11.7, CUDA device: 0
2024-11-14 18:30:27.223 INFO: Loading 3BPA dataset
2024-11-14 18:30:31.044 INFO: Number of configurations: train=450, valid=50, tests=[1669, 2138, 2139, 7047]
2024-11-14 18:30:31.046 INFO: AtomicNumberTable: (1, 6, 7, 8)
2024-11-14 18:30:31.942 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1000.000)
2024-11-14 18:30:31.999 INFO: Average number of neighbors: 16.712
2024-11-14 18:30:31.999 INFO: Building model
2024-11-14 18:30:42.668 INFO: EquivariantRealScaleShiftNonLinearBodyOrderedModel(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 256x0e | 1024 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5872, -1029.4890, -1484.9814, -2041.9816])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
      (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
      (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e x 4x0e -> 256x0e+256x1o+256x2e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
      (conv_tp): TensorProduct(256x0e+256x1o+256x2e x 1x0e+1x1o+1x2e+1x3o -> 768x0e+1280x1o+1280x2e+1024x3o | 4352 paths | 4352 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 4352]
      (linear): Linear(768x0e+1280x1o+1280x2e+1024x3o -> 256x0e+256x1o+256x2e+256x3o | 1114112 weights)
      (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o+256x2e x 4x0e -> 256x0e | 262144 paths | 262144 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x3 (GPU 0)]
        )
        (tps): ModuleDict(
          (1): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=14x13 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e | 11 weights)
          )
          (2): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=20x19 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e -> 1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e | 11 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=20x19 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=8 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=8 res=20x19 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+2x5o+1x5e+1x6o+2x6e+2x7o+1x7e+1x8o+1x8e+1x9o -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e+1x7o+1x8e+1x9o | 17 weights)
          )
        )
      )
      (linear): Linear(256x0e+256x1o+256x2e -> 256x0e+256x1o+256x2e | 196608 weights)
    )
    (1): EquivariantProductBasisBlock(
      (efficient_multi_tensorproduct): EfficientMultiTensorProductS2Grid(
        (weights): ParameterDict(
            (1): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (2): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
            (3): Parameter containing: [torch.cuda.FloatTensor of size 1x4x256x1 (GPU 0)]
        )
        (tps): ModuleDict(
          (1): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=14x13 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=14x13 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=14x13 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e | 11 weights)
          )
          (2): VectorGauntTensorProductS2Grid(
            (vsh1): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=5 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=5 res=20x19 (beta x alpha))
            )
            (linear1): Linear(1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e -> 1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+1x5o+1x5e+1x6e | 11 weights)
            (vsh2): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=2 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=2 res=20x19 (beta x alpha))
            )
            (linear2): Linear(1x0e+1x1o+1x2e+1x3o -> 1x0e+2x1o+1x1e+1x2o+1x2e+1x3o | 5 weights)
            (vsh_out): VectorSphericalHarmonics(
              (to_s2grid): ToS2Grid(lmax=8 res=20x19 (beta x alpha))
              (from_s2grid): FromS2Grid(lmax=8 res=20x19 (beta x alpha))
            )
            (linear_out): Linear(1x0e+2x1o+1x1e+1x2o+2x2e+2x3o+1x3e+1x4o+2x4e+2x5o+1x5e+1x6o+2x6e+2x7o+1x7e+1x8o+1x8e+1x9o -> 1x0e+1x1o+1x2e+1x3o+1x4e+1x5o+1x6e+1x7o+1x8e+1x9o | 17 weights)
          )
        )
      )
      (linear): Linear(256x0e -> 256x0e | 65536 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(256x0e+256x1o+256x2e -> 1x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.945654, shift=-4.873201)
)
2024-11-14 18:30:42.671 INFO: Number of parameters: 2804092
2024-11-14 18:30:42.671 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: interactions
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2024-11-14 18:30:42.671 INFO: Started training
2024-11-14 18:31:39.474 INFO: Epoch 0: loss=64.9128
2024-11-14 18:33:15.447 INFO: Epoch 2: loss=16.0820
2024-11-14 18:34:51.419 INFO: Epoch 4: loss=9.0599
2024-11-14 18:36:27.418 INFO: Epoch 6: loss=5.9578
2024-11-14 18:38:03.369 INFO: Epoch 8: loss=4.4860
